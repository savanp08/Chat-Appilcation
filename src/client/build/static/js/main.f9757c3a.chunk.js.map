{"version":3,"sources":["Components/ChatScopeSwitch/ChatScopeSwitch.js","Components/ProfileDisplay&Rooms/ProfileDisplay&Rooms.js","Components/Message/Message.js","Components/Mui/AddRoom-Component.js","Components/Mui/RemoveRoom-Component.js","Components/Mui/RoomHeaderOptionsContainer.js","Components/Mui/RoomHeaderOptions.js","Components/Additional_Components/ChatWindow_AddMember.js","Components/Additional_Components/ChatWindow_RemoveMember.js","Components/Additional_Components/ChatWindowOptionsContainer.js","Components/Additional_Components/ChatWindowOptions.js","Components/Posts/Posts.js","Components/ChatWindow/ChatWindow.js","Components/Home/Home.js","Components/Login/Login.js","Components/Login/SignUp.js","Components/ChatWindow/QuickChat.js","Components/RoutesComponent.js","App.js","index.js"],"names":["ChatScopeSwitch","personalKey","globalKey","useState","activeKey","setActiveKey","handleTabSwitch","prop","console","log","className","onClick","ProfileDisplay","ProfilePic","ProfileName","LastMessage","src","alt","id","Message","own","Name","Img","MessageText","TimeStamp","Media","AddRoom_Component","socket","UserName","useParams","NewRoomName","MemArr","ActualMem","addRoom","push","UserId","NewRoomNamex","document","getElementById","value","length","window","alert","NewRoomId","mongoose","Types","ObjectId","toString","joinRoom","NewRoom","emit","createRoom","axios","post","RoomId","Members","Messages","RoomType","then","res","data","forEach","key","checkUser","catch","err","x","get","status","addUserToRoom","Paper","component","sx","p","display","alignItems","maxWidth","maxHeight","flexFlow","justifyContent","TextField","required","label","defaultValue","placeholder","Box","width","marginTop","color","mr","my","variant","Button","y","addUser","overflowX","overFlowY","map","ele","RemoveRoom_Component","Rooms","React","FilterQuery","setFilterQuery","RoomsArr","list","getElementsByClassName","i","childNodes","nodeValue","toLowerCase","includes","toLocaleLowerCase","style","count","removeRoom","UserNamex","deleteRoom","onChange","e","target","overflowY","keys","innerHTML","RoomHeaderOpenOptionsContainer","SelectedOption","classList","remove","add","addEventListener","removeEventListener","RoomsList","RoomHeaderOptions","setSelectedOption","anchorEl","setAnchorEl","open","setOpen","IconButton","undefined","event","currentTarget","Menu","MenuListProps","onClose","PaperProps","ITEM_HEIGHT","option","MenuItem","selected","ChatWindow_AddMember","ActiveRoomId","UserType","ChatWindow_RemoveMember","MembersArr","removeMember","deleteMember","ChatWindowOptionsContainer","MembersList","ChatWindowOptions","Post","Sender","PostText","PostId","slide","setslide","useEffect","container","len","offsetLeft","scrollLeft","MediaArr","position","justifySelf","marginLeft","alignSelf","height","cursor","media","img","index","userid","ChatWindow","Map","setRooms","setMembers","setActiveRoomId","setMessages","setLastMessage","ActiveWindow","msg","setMsg","Lastmsg","setLastMsg","room","setroom","delmsg","setdelmsg","delmem","setdelmem","delroom","setdelroom","mem","setmem","flag","setflag","flagLoadMessages","setFlagLoadMessages","DisplayDataType","setDisplayDataType","Posts","setPosts","Queries","setQueries","setpost","query","setquery","FullRoomData","setFullRoomData","ActiveMembers","setActiveMembers","params","location","replace","AccessToken","localStorage","getItem","headers","Response","resval","error","set","Status","clear","Temp","message","MessageId","QueryId","member","msgMap","PostsMap","QueriesMap","MemMap","pos","que","setSocket","process","fakePort","hostname","io","on","roomsArray","removeAllListeners","off","Object","has","delete","Array","isArray","userId","disconnect","sendMessage","NewMessage","files","NewMessageId","file","formData","FormData","NewFiles","append","path","date","Date","now","entries","pair","sendPost","NewPost","NewPostId","pusher","Pusher","cluster","encrypted","deleteChannel","subscribe","bind","unsubscribe","temp","scrollToBottom","wid","innerWidth","innerHeight","this","contains","messagesEndRef","useRef","current","scrollIntoView","behavior","ScrollToBottomCustom","div","Container","offsetTop","scrollTop","InputBase","FilterRooms","ml","flex","inputProps","Divider","m","orientation","roomid","body","clientWidth","ChatContainer","RoomDetails","marginRight","size","time","split","ref","multiline","maxRows","val","URL","createObjectURL","onKeyPress","ev","shiftKey","preventDefault","margin","boxShadow","typedMssg","htmlFor","accept","multiple","type","Home","Login","setUserName","Password","setPassword","SetMessage","setAccessToken","CheckMessage","String","accessToken","token","setItem","authorization","createQuickRoom","tempUserId","roomId","tempName","quickButton","CheckUserName","fontSize","wordSpacing","lineHeight","InputLabelProps","CheckPassword","name","submitLogin","SignUp","setActiveWindow","Rerender","setRerender","NewUser","deleteUser","RoutesComponent","exact","element","QuickChat","App","ReactDOM","render"],"mappings":"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","file":"static/js/main.f9757c3a.chunk.js","sourcesContent":["import React from 'react';\r\nimport { useEffect, useState } from 'react';\r\n//import {BrowserRouter as Router, Link, Route, Switch} from 'react-router-dom';\r\nimport './ChatScopeSwitch.css';\r\n\r\nconst ChatScopeSwitch=()=> {\r\n    const personalKey= 'personalKey', globalKey='globalKey';\r\n    const [activeKey, setActiveKey] = useState('personalKey');\r\n    \r\n   const handleTabSwitch=(activeKey, prop)=>{\r\n       console.log({activeKey});\r\n       console.log({prop});\r\n        if(prop===activeKey) {\r\n            return;\r\n        }\r\n        else {\r\n            if(activeKey===personalKey) setActiveKey('globalKey');\r\n            else setActiveKey('personalKey');\r\n        }\r\n     }\r\n//console.log({activeKey});\r\n return (\r\n     <>\r\n   \r\n     <div className=\"ChatScopeSwitch-container\" >\r\n         \r\n         <div className={\"ChatScopeSwitch-Element-container\"+(activeKey===globalKey? \" active\" : \"\")} onClick={()=>handleTabSwitch(activeKey, globalKey)}>\r\n         <p className=\"ChatScopeSwitch-Menu_Element gradient-text\">\r\n         Global\r\n             \r\n         </p>\r\n     </div>\r\n\r\n     <div className={\"ChatScopeSwitch-Element-container\"+(activeKey===personalKey? \" active\" : \"\")} onClick={()=>handleTabSwitch(activeKey, personalKey)}>\r\n         <p className=\"ChatScopeSwitch-Menu_Element gradient-text\" >\r\n         Personal\r\n         </p>\r\n     </div>\r\n     </div>\r\n     \r\n    </> \r\n );\r\n}\r\n\r\nexport default ChatScopeSwitch;\r\n","import React from 'react' ;\r\nimport './ProfileDisplay&Rooms.css' ;\r\n\r\n const  ProfileDisplay=({ProfilePic,ProfileName,LastMessage})=> {\r\n     \r\n    var priority,count; \r\n      return( \r\n      <div className=\"Profile-Wrapper\" > \r\n      <div className=\"Contact\"> \r\n     \r\n     <div className=\"Contact-ProfilePic-Container\">\r\n     \r\n      <img className = \"Contact-ProfilePic\" src =\"https://previews.123rf.com/images/grandeduc/grandeduc1603/grandeduc160300008/54330729-reaper-moon-rising-3d-render-of-cratered-skull-moon-in-night-sky.jpg\" alt=\"Not Loaded\" ></img>\r\n      </div>\r\n      <div className=\"Contact-BasicInfo\"> \r\n     \r\n      <div className=\"Profile-Name Text-Control-Box Contact-Text-Width\" >\r\n      <p  id=\"Room-ProfileName\"  className=\"User-ProfileName Text-Control-Box\" >{ProfileName}</p>\r\n       </div>\r\n       <div className=\"Last-Message Text-Control-Box \" >\r\n       <span className=\"Last-Message Text-Control-Box\">{LastMessage}</span> \r\n      </div> \r\n      </div>\r\n       </div> \r\n       </div>\r\n        ); \r\n    }\r\n    \r\n                    \r\n       export default ProfileDisplay;\r\n                 \r\n","import React from 'react'\r\n import './Message.css'\r\n\r\nconst Message = ({own,Img,Name,MessageText,TimeStamp,Media}) =>{  \r\n    var lu=[\"URNOOB\"],mu=[\"UR NOOB\"],Mssg = \"\";\r\n   console.log(\"Debug-> Msg->\",own,Name);\r\n   \r\nreturn(\r\n    <div className={\"Message-Over-Wrapper\" +(own===true? \" Own\"  : \"\")} >\r\n    <div className={\"Message-Wrapper\" +(own===true? \" Own\"  : \"\")}>\r\n        <div className={\"Message\"+(own===true? \" Own\"  : \"\")}>\r\n            <div className=\"Sender-Image-Wrapper close\">\r\n            <img className=\"Sender-Image\" src =\"https://previews.123rf.com/images/grandeduc/grandeduc1603/grandeduc160300008/54330729-reaper-moon-rising-3d-render-of-cratered-skull-moon-in-night-sky.jpg\" alt=\"Not Loaded\"></img>\r\n            </div>\r\n            <div className='MessageComponent-ContentWrapper' id=\"MessageComponent-ContentWrapper\">\r\n            <div className=\"Sender-Name-wrapper close\">\r\n            <p className={\"Sender-Name\" +(own===true? \" Own\"  : \"\")}>{Name}</p>\r\n            </div>\r\n                <div className={'Message-MediaWrapper'+(Media? \"\" : \" Hide\") } id=\"Message-MediaWrapper\">\r\n                <img className='Message-Media' src={Media} alt=\"\"  />\r\n                </div>\r\n            <div className=\"Text_Wrapper\">\r\n            \r\n            <div className=\"Message-Text-wrapper close\">\r\n            <div className={\"Message-Text\" +(own===true? \" Own\"  : \"\")}> {MessageText} </div>\r\n            </div>\r\n            <div className=\"TimeStamp-wrapper close\">\r\n            <p className=\"TimeStamp\">{TimeStamp}</p>\r\n            </div>\r\n            </div>\r\n            </div>\r\n        </div>\r\n    </div>\r\n    </div>\r\n);  \r\n\r\n }\r\n\r\n\r\n export default Message;","import * as React from 'react';\r\nimport Paper from '@mui/material/Paper';\r\nimport InputBase from '@mui/material/InputBase';\r\nimport Divider from '@mui/material/Divider';\r\nimport IconButton from '@mui/material/IconButton';\r\nimport MenuIcon from '@mui/icons-material/Menu';\r\nimport SearchIcon from '@mui/icons-material/Search';\r\nimport DirectionsIcon from '@mui/icons-material/Directions';\r\nimport Box from '@mui/material/Box';\r\nimport TextField from '@mui/material/TextField';\r\nimport AccountCircle from '@mui/icons-material/AccountCircle';\r\nimport InputAdornment from '@mui/material/InputAdornment';\r\nimport FormControl from '@mui/material/FormControl';\r\nimport Input from '@mui/material/Input';\r\nimport InputLabel from '@mui/material/InputLabel';\r\nimport { Button } from '@mui/material';\r\nimport { useParams } from 'react-router-dom';\r\nimport axios from 'axios';\r\nimport mongoose from 'mongoose';\r\nimport './RoomOptions.css';\r\nimport { Socket } from 'socket.io-client';\r\n\r\n\r\n const AddRoom_Component = ({socket}) => {\r\n  console.log(\"props are  Socket->\",socket);\r\n  var UserName = useParams().UserName;\r\n  var NewRoomName = \"\";\r\n  const MemArr = [];\r\n  var ActualMem=[];\r\n  function addUser(){\r\n    var y = document.getElementById('AddUser-TextArea');\r\n   \r\n    if(y){\r\n       var x = y.value;\r\n       console.log(x);\r\n        MemArr.push(x);\r\n        y.value=\"\";\r\n    }\r\n    console.log(\"Members to be added to New Room->\",MemArr);\r\n  };\r\nconst addRoom = async()=>{\r\n   ActualMem = [];\r\n  ActualMem.push({\r\n    UserId:UserName,\r\n    Name:\"TestAccount\"\r\n  });\r\n  var NewRoomNamex = document.getElementById(\"RoomName-AddRoom\");\r\n  if(NewRoomNamex){\r\n    NewRoomName = NewRoomNamex.value;\r\n  }\r\n    if(NewRoomName.length<3) {\r\n      window.alert(\"Room Name Length Should be atLeast 3\");\r\n      return;\r\n    }\r\n \r\n  var NewRoomId = new mongoose.Types.ObjectId();\r\n  NewRoomId=NewRoomId.toString();\r\n  console.log(\"Creating Room with->\",NewRoomId);\r\n\r\n    joinRoom(NewRoomId);\r\n   \r\n}\r\n\r\n\r\nconst joinRoom = async(NewRoomId)=>{\r\n  console.log(\"Joning Room in socket server->\",NewRoomId);\r\n  var NewRoom = [];\r\n  NewRoom.push(NewRoomId);\r\n  NewRoom.push(UserName);\r\n socket.emit(\"joinRoom\",NewRoom);\r\n createRoom(NewRoomId);\r\n}\r\nconst createRoom = async(NewRoomId) =>{\r\n\r\n  \r\n\r\n  await axios.post(`/Server/Rooms/Room/create/${UserName}`,\r\n  {\r\n    RoomId:NewRoomId,\r\n    Name:NewRoomName,\r\n    Members : ActualMem,\r\n    Messages:[],\r\n    RoomType : \"Auth\"\r\n})\r\n.then(res=>{\r\n  console.log(\"created new room\",res.data);\r\n  MemArr.forEach(key=>{\r\n    checkUser(key,NewRoomId);\r\n  })\r\n})\r\n.catch(err=>{\r\n  console.log(\"Err in creating room\",err);\r\n});\r\n}\r\nconst checkUser = async(UserId,RoomId)=>{\r\n  \r\n  console.log(\"Member to be added to this Room->\",UserId,RoomId);\r\n var x = UserId;\r\n  var flag = true;\r\n\r\n  await axios.get(`/Server/Auth/CheckUser/${x}`).then(res=>{\r\n    if(res.status===200 || res.data === \"Found\") flag=true;\r\n    else flag=false;\r\n    if(flag) addUserToRoom(x,RoomId);\r\n  }).catch(err=>{\r\n    console.log(err)\r\n})\r\n\r\n  \r\n};\r\n\r\nconst addUserToRoom = async(x,RoomId) =>{\r\n\r\n  await axios.post(`/Server/Rooms/Room/add/User/${RoomId}`,\r\n{\r\nUserId:x,\r\nName:\"Temp User\",\r\nRoomId:RoomId\r\n})\r\n.then(res=>{\r\nconsole.log(\"Added new Member\",res.data);\r\n})\r\n.catch(err=>{\r\nconsole.log(\"Err in adding Member\",err);\r\n});\r\n\r\n}\r\n\r\n  return (\r\n    <Paper\r\n      component=\"form\"\r\n      sx={{ p: '2px 4px' , display: 'flex', alignItems: 'center', maxWidth: 400 ,maxHeight:500 \r\n          , flexFlow:'column wrap', justifyContent:'space-around'\r\n    }} \r\n    >\r\n      \r\n      <TextField\r\n          required\r\n          id=\"RoomName-AddRoom\"\r\n          label=\"Room Name\"\r\n          defaultValue=\"\"\r\n          placeholder='Room Name'\r\n        />\r\n        \r\n        <Box sx={{ display: 'flex', alignItems: 'flex-end' ,\r\n      width:\"100%\" , marginTop:'15px'\r\n      }}>\r\n        <AccountCircle sx={{ color: 'action.active', mr: 1, my: 0.5 }} />\r\n        <TextField id=\"AddUser-TextArea\" label=\"UserName\" variant=\"standard\" />\r\n        </Box>\r\n        <Button variant=\"contained\"\r\n        sx={{\r\n          marginTop:'8px'\r\n        }}\r\n        onClick={()=>{\r\n          addUser();\r\n        }}\r\n        >Add User</Button>\r\n      \r\n      <Box sx={{ \r\n     maxHeight:'120px', maxWidth:'170px', overflowX:'hidden' , \r\n     overFlowY:'scroll' , display:'flex' , flexFlow:'column wrap' ,\r\n     marginTop:'13px'\r\n    }}>\r\n       {\r\n        MemArr.map(ele=>{\r\n          return(\r\n           <div className='AddUser-AddRoom'>\r\n            <div className='UserName-AddRoom'>\r\n                 {ele}\r\n              </div>\r\n           </div>\r\n          );\r\n          \r\n        })\r\n       }\r\n      </Box>\r\n      <Button variant=\"contained\"\r\n      sx={{\r\n        marginTop:'10px'\r\n      }}\r\n        onClick={()=>{\r\n          addRoom();\r\n        }}\r\n        >Add Room</Button>\r\n    </Paper>\r\n  );\r\n}\r\n\r\nexport default AddRoom_Component;","import * as React from 'react';\r\nimport Paper from '@mui/material/Paper';\r\nimport InputBase from '@mui/material/InputBase';\r\nimport Divider from '@mui/material/Divider';\r\nimport IconButton from '@mui/material/IconButton';\r\nimport MenuIcon from '@mui/icons-material/Menu';\r\nimport SearchIcon from '@mui/icons-material/Search';\r\nimport DirectionsIcon from '@mui/icons-material/Directions';\r\nimport Box from '@mui/material/Box';\r\nimport TextField from '@mui/material/TextField';\r\nimport AccountCircle from '@mui/icons-material/AccountCircle';\r\nimport InputAdornment from '@mui/material/InputAdornment';\r\nimport FormControl from '@mui/material/FormControl';\r\nimport Input from '@mui/material/Input';\r\nimport InputLabel from '@mui/material/InputLabel';\r\nimport { Button } from '@mui/material';\r\nimport { useParams } from 'react-router-dom';\r\nimport axios from 'axios';\r\nimport './RoomOptions.css';\r\n\r\n const RemoveRoom_Component = ({Rooms,socket}) => {\r\nconst [FilterQuery , setFilterQuery] = React.useState(\"\");\r\nconsole.log(\"props are Rooms and Socket->\",Rooms,socket);\r\nconst RoomsArr = Rooms;\r\nReact.useEffect(()=>{\r\n  console.log(\"search filter is \",FilterQuery);\r\n  const temp=document.getElementById(\"RemoveRoomsList\");\r\n  const list = temp.getElementsByClassName(\"RemoveRoom-Container\");\r\n    for(var i=0;i<list.length;i++){\r\n      const x = list[i].getElementsByClassName(\"RemoveRoomName\")[0];\r\n      console.log(\"Sub Div in filtering loop\",x.childNodes[0].nodeValue);\r\n      const y = x.childNodes[0].nodeValue;\r\n      if(y.toLowerCase().includes(FilterQuery.toLocaleLowerCase())){\r\n      list[i].style.display=\"\";\r\n       console.log(\"Element checking for filterting in remove Room\",y);\r\n      }\r\n      else\r\n      list[i].style.display=\"none\";\r\n    }\r\n},[FilterQuery]);\r\n\r\nvar count=0;\r\nvar removeRoom = {};\r\nconsole.log(\"in remove Room->\");\r\nconsole.log(\"Remove Rooms->\",Rooms);\r\nvar UserNamex  = useParams();\r\nvar UserName=\"\";\r\nconst deleteRoom = async() =>{\r\n\r\nif(UserNamex.UserName) UserName=UserNamex.UserName;\r\nconsole.log(removeRoom);\r\nvar RoomId = removeRoom.RoomId;\r\nconsole.log(\"Deleteing USer \",UserName,\"from Room\",RoomId);\r\nawait axios.post(`/Server/Rooms/Room/Delete/Member/${RoomId}/${UserName}`)\r\n.then(res=>{\r\n  console.log(res.data);\r\n  var x = document.getElementById('RemoveRoom-SearchArea');\r\n  if(x) x.value = \"\";\r\n}).catch(err=>{\r\n  console.log(err);\r\n});\r\n\r\n\r\n}\r\n\r\n\r\n  return (\r\n    <Paper\r\n      component=\"form\"\r\n      sx={{ p: '2px 4px' , display: 'flex', alignItems: 'center', maxWidth: 400 ,flexFlow:'column wrap',justifyContent:'space-around' }}\r\n    >\r\n      <TextField\r\n          required\r\n          id=\"RemoveRoom-SearchArea\"\r\n          label=\"Room Name\"\r\n          defaultValue=\"\"\r\n          placeholder='Room Name'\r\n          onChange={(e)=>{\r\n                setFilterQuery(e.target.value);\r\n          }}\r\n        />\r\n            <div id=\"RemoveRoomsList\" >\r\n        <Box  \r\n        sx={{ \r\n            maxHeight:'400px', maxWidth:'400px', overflowX:'scroll' , overflowY:'scroll' , display:'flex' , flexFlow:'column nowrap' \r\n        }}\r\n      >\r\n        {\r\n        [...RoomsArr.keys()].map(key=>{ ++count;\r\n         \r\n          return(\r\n          <div className=\"RemoveRoom-Container\"  id={`RemoveRoom${count}`} onClick={()=>{ \r\n            console.log(\"User\",UserName,\" is going be deleted from roomID\",key);\r\n            document.getElementById(\"RemoveRoom-Output\").innerHTML=`Selected Room : ${RoomsArr.get(key).Name}`\r\n            removeRoom = {\r\n              RoomId:key,\r\n              Name:RoomsArr.get(key).Name\r\n            }\r\n           }}>\r\n            <div className='RoomPic'>\r\n              <img src={RoomsArr.get(key).Img} />\r\n            </div>\r\n            <div className='RemoveRoomName'>\r\n                {/* {RoomsArr.get(key).Name} */}\r\n                {RoomsArr.get(key).Name}\r\n                </div>\r\n                \r\n          </div>\r\n          );\r\n        })\r\n    }\r\n      </Box>\r\n      </div>\r\n     <p id=\"RemoveRoom-Output\" className=\"RemoveRoom-Output\"></p>\r\n      <div className='SubmitRemoveRoom'>\r\n      <Button variant=\"contained\"\r\n      sx={{\r\n        marginTop:'10px'\r\n      }}\r\n        onClick={()=>{\r\n          deleteRoom();\r\n        }}\r\n        >Remove Room</Button>\r\n      </div>\r\n    </Paper>\r\n  );\r\n}\r\n\r\nexport default RemoveRoom_Component;","import * as React from 'react';\r\nimport AddRoom_Component from './AddRoom-Component';\r\nimport RemoveRoom_Component from './RemoveRoom-Component';\r\nimport './RoomOptions.css';\r\n\r\n\r\n\r\nconst RoomHeaderOpenOptionsContainer = ({socket,SelectedOption,Rooms}) =>{\r\n  console.log(\"props are Rooms and Socket->\",Rooms,socket);\r\n  if(SelectedOption===\"None\"){\r\n     var x = document.getElementById('RoomSearchBarContainer');\r\n     if(x) x.classList.remove('Hide');\r\n  }\r\n  else{\r\n    var x = document.getElementById('RoomSearchBarContainer');\r\n    if(x) x.classList.add('Hide');  }\r\n\r\n   React.useEffect(()=>{\r\n    window.addEventListener('click',function(){\r\n\r\n    });\r\n\r\n    return()=>{\r\n      window.removeEventListener('click',function(){\r\n        console.log(\"Removed\");\r\n      });\r\n    }\r\n   },[])\r\n\r\nconst RoomsList = Rooms;\r\n    console.log(\"In Room Open Options->\");\r\n    console.log(\"Rooms passed to Open Options in Room Section are->\",Rooms);\r\n    console.log(\"IN Open _> Selcted Option is \",SelectedOption);\r\n\r\n    return(\r\n<div className='RoomOptions-Wrapper' id=\"RoomOptions-Wrapper\" >\r\n      <div className={ \"AddRoom-Container\" +(SelectedOption===\"Add Room\"? \"\" : \" Hide\") }>\r\n        <AddRoom_Component socket={socket} />\r\n      </div>\r\n      <div className={ \"RemoveRoom-Container\" +(SelectedOption===\"Delete Chat & Room\"? \"\" : \" Hide\") }>\r\n       <RemoveRoom_Component Rooms={RoomsList} socket={socket}/>\r\n      </div>\r\n    </div>\r\n    );\r\n};\r\n\r\n\r\nexport default RoomHeaderOpenOptionsContainer;","import * as React from 'react';\r\nimport IconButton from '@mui/material/IconButton';\r\nimport Menu from '@mui/material/Menu';\r\nimport MenuItem from '@mui/material/MenuItem';\r\nimport MoreVertIcon from '@mui/icons-material/MoreVert';\r\nimport RoomHeaderOpenOptionsContainer from './RoomHeaderOptionsContainer';\r\nimport MenuIcon from '@mui/icons-material/Menu';\r\n\r\nconst RoomHeaderOptions = ({socket,Rooms}) =>{\r\n  console.log(\"props are Rooms and Socket->\",Rooms,socket);\r\n  const [SelectedOption,setSelectedOption] = React.useState(\"None\");\r\nconst options = [\r\n  'None',\r\n  'Add Room',\r\n  'Delete Chat & Room'\r\n];\r\nvar RoomsList =Rooms;\r\nconsole.log(\"Rooms List in Room Header Options is \",RoomsList);\r\nconst ITEM_HEIGHT = 48;\r\n  const [anchorEl, setAnchorEl] = React.useState(null);\r\n  const [open , setOpen] = React.useState();\r\n  const handleClick = (event) => {\r\n    setAnchorEl(event.currentTarget);\r\n    console.log(\"Selected option is \",event);\r\n    setOpen(true);\r\n  };\r\n  const handleClose = () => {\r\n    setAnchorEl(null);\r\n  setOpen(false);\r\n  };\r\n\r\n  React.useEffect(()=>{\r\n    window.addEventListener('click',function(){\r\n        \r\n    });\r\n\r\n    return()=>{\r\n      window.removeEventListener('click',function(){\r\n        console.log(\"Removed\");\r\n      });\r\n    }\r\n   },[])\r\n\r\nconsole.log(\"In Room Header Options->\");\r\nconsole.log(\"Room Header Rooms->\",Rooms);\r\n\r\n  return (\r\n    <div>\r\n    <div>\r\n      <IconButton\r\n        aria-label=\"more\"\r\n        id=\"RoomHeader-OptionsMenu-Icon\"\r\n        aria-controls={open ? 'long-menu' : undefined}\r\n        aria-expanded={open ? 'true' : undefined}\r\n        aria-haspopup=\"true\"\r\n        onClick={handleClick}\r\n      >\r\n        \r\n        <MenuIcon />\r\n     \r\n      </IconButton>\r\n      <Menu\r\n        id=\"long-menu\"\r\n        MenuListProps={{\r\n          'aria-labelledby': 'long-button',\r\n        }}\r\n        anchorEl={anchorEl}\r\n        open={open}\r\n        onClose={handleClose}\r\n        PaperProps={{\r\n          style: {\r\n            maxHeight: ITEM_HEIGHT * 4.5,\r\n            width: '20ch',\r\n          },\r\n        }}\r\n      >\r\n        {options.map((option) => (\r\n          <MenuItem key={option} selected={option === anchorEl} onClick={()=>{setSelectedOption(option); setOpen(false);}}>\r\n            {option}\r\n          </MenuItem>\r\n        ))}\r\n      </Menu>\r\n    </div>\r\n    <RoomHeaderOpenOptionsContainer  SelectedOption={SelectedOption}  Rooms={RoomsList}   socket={socket} />\r\n    </div>\r\n\r\n    \r\n\r\n\r\n  );\r\n}\r\n\r\nexport default RoomHeaderOptions;","import * as React from 'react';\r\nimport Paper from '@mui/material/Paper';\r\nimport InputBase from '@mui/material/InputBase';\r\nimport Divider from '@mui/material/Divider';\r\nimport IconButton from '@mui/material/IconButton';\r\nimport MenuIcon from '@mui/icons-material/Menu';\r\nimport SearchIcon from '@mui/icons-material/Search';\r\nimport DirectionsIcon from '@mui/icons-material/Directions';\r\nimport Box from '@mui/material/Box';\r\nimport TextField from '@mui/material/TextField';\r\nimport AccountCircle from '@mui/icons-material/AccountCircle';\r\nimport InputAdornment from '@mui/material/InputAdornment';\r\nimport FormControl from '@mui/material/FormControl';\r\nimport Input from '@mui/material/Input';\r\nimport InputLabel from '@mui/material/InputLabel';\r\nimport { Button } from '@mui/material';\r\nimport { useParams } from 'react-router-dom';\r\nimport axios from 'axios';\r\nimport './ChatWindowOptions.css';\r\n\r\n\r\n const ChatWindow_AddMember = ({ActiveRoomId,Members}) => {\r\n  var RoomType =\"Rooms\";\r\n  var UserName = useParams().UserName;\r\n  var RoomId = ActiveRoomId;\r\n  if(useParams().UserType===\"QuickUser\") RoomType=\"QuickRoom\";\r\n  console.log(\"Room Id Passed to ADD user is ->\",ActiveRoomId);\r\n  const checkUser = async()=>{\r\n    var y = document.getElementById('ChatWindow-AddUser-TypeArea');\r\n   var x = \"\";\r\n    if(y){\r\n        x = y.value;\r\n       console.log(x);\r\n        y.value=\"\";\r\n    }\r\n    console.log(\"Member to be added to this Room->\",x);\r\n   \r\n    var flag = true;\r\n\r\n    await axios.get(`/Server/Auth/CheckUser/${x}`).then(res=>{\r\n      if(res.status===200 || res.data === \"Found\") flag=true;\r\n      else flag=false;\r\n      if(flag) addUser(x,RoomId);\r\n    }).catch(err=>{\r\n      console.log(err)\r\n  })\r\n\r\n    \r\n  };\r\n \r\n const addUser = async(x,RoomId) =>{\r\n  \r\n    await axios.post(`/Server/${RoomType}/Room/add/User/${RoomId}`,\r\n{\r\nUserId:x,\r\nName:\"Temp User\",\r\nRoomId:RoomId\r\n})\r\n.then(res=>{\r\nconsole.log(\"Added new Member\",res.data);\r\n})\r\n.catch(err=>{\r\nconsole.log(\"Err in adding Member\",err);\r\n});\r\n\r\n }\r\n  return (\r\n    <Paper\r\n      component=\"form\"\r\n      sx={{ p: '2px 4px' , display: 'flex', alignItems: 'center', maxWidth: 400 ,maxHeight:500 \r\n          , flexFlow:'column wrap', justifyContent:'space-around'\r\n    }} \r\n    >\r\n      \r\n      <TextField\r\n          required\r\n          id=\"ChatWindow-AddUser-TypeArea\"\r\n          label=\"Member UserName\"\r\n          defaultValue=\"\"\r\n          placeholder='Member UserName'\r\n        />\r\n        \r\n     \r\n        <Button variant=\"contained\"\r\n        sx={{\r\n          marginTop:'8px'\r\n        }}\r\n        onClick={()=>{\r\n          checkUser();\r\n        }}\r\n        >Add User</Button>\r\n      \r\n     \r\n    </Paper>\r\n  );\r\n}\r\n\r\nexport default ChatWindow_AddMember;","import * as React from 'react';\r\nimport Paper from '@mui/material/Paper';\r\nimport InputBase from '@mui/material/InputBase';\r\nimport Divider from '@mui/material/Divider';\r\nimport IconButton from '@mui/material/IconButton';\r\nimport MenuIcon from '@mui/icons-material/Menu';\r\nimport SearchIcon from '@mui/icons-material/Search';\r\nimport DirectionsIcon from '@mui/icons-material/Directions';\r\nimport Box from '@mui/material/Box';\r\nimport TextField from '@mui/material/TextField';\r\nimport AccountCircle from '@mui/icons-material/AccountCircle';\r\nimport InputAdornment from '@mui/material/InputAdornment';\r\nimport FormControl from '@mui/material/FormControl';\r\nimport Input from '@mui/material/Input';\r\nimport InputLabel from '@mui/material/InputLabel';\r\nimport { Button } from '@mui/material';\r\nimport { useParams } from 'react-router-dom';\r\nimport axios from 'axios';\r\nimport './ChatWindowOptions.css';\r\n\r\n const ChatWindow_RemoveMember = ({Members,ActiveRoomId}) => {\r\nconst [FilterQuery , setFilterQuery] = React.useState(\"\");\r\nvar RoomType = \"Rooms\";\r\nif(useParams().UserType===\"QuickUser\") RoomType=\"QuickRoom\";\r\n\r\nconsole.log(\"Room Id Passed to Remove user is ->\",ActiveRoomId);\r\nconst MembersArr = Members;\r\nReact.useEffect(()=>{\r\n  console.log(\"search filter is \",FilterQuery);\r\n  const temp=document.getElementById(\"RemoveMembersList\");\r\n  const list = temp.getElementsByClassName(\"RemoveMember-Container\");\r\n    for(var i=0;i<list.length;i++){\r\n      const x = list[i].getElementsByClassName(\"RemoveMemberName\")[0];\r\n      console.log(\"Sub Div in filtering loop\",x.childNodes[0].nodeValue);\r\n      const y = x.childNodes[0].nodeValue;\r\n      if(y.toLowerCase().includes(FilterQuery.toLocaleLowerCase())){\r\n      list[i].style.display=\"\";\r\n       console.log(\"Element checking for filterting in remove Member\",y);\r\n      }\r\n      else\r\n      list[i].style.display=\"none\";\r\n    }\r\n},[FilterQuery]);\r\n\r\nvar count=0;\r\nvar removeMember = \"\";\r\nconsole.log(\"in remove Member->\");\r\nconsole.log(\"Remove Members->\",Members);\r\nvar UserNamex  = useParams();\r\nvar UserName=\"\";\r\nconst deleteMember = async() =>{\r\n\r\nif(UserNamex.UserName) UserName=UserNamex.UserName;\r\nconsole.log(removeMember);\r\nvar RoomId = ActiveRoomId;\r\nconsole.log(\"Deleteing User \",removeMember,\"from Room\",RoomId);\r\nawait axios.post(`/Server/${RoomType}/Delete/Member/${ActiveRoomId}/${removeMember}`)\r\n.then(res=>{\r\n  console.log(res.data);\r\n  var x = document.getElementById('RemoveMember-SearchArea');\r\n  if(x) x.value = \"\";\r\n}).catch(err=>{\r\n  console.log(err);\r\n});\r\n\r\n\r\n}\r\n\r\n\r\n  return (\r\n    <Paper\r\n      component=\"form\"\r\n      sx={{ p: '2px 4px' , display: 'flex', alignItems: 'center', maxWidth: 400 ,flexFlow:'column wrap',justifyContent:'space-around' }}\r\n    >\r\n      <TextField\r\n          required\r\n          id=\"RemoveMember-SearchArea\"\r\n          label=\"Member UserName\"\r\n          defaultValue=\"\"\r\n          placeholder='Member UserName'\r\n          onChange={(e)=>{\r\n                setFilterQuery(e.target.value);\r\n          }}\r\n        />\r\n            <div id=\"RemoveMembersList\" >\r\n        <Box  \r\n        sx={{ \r\n            maxHeight:'300px', maxWidth:'300px', overflowX:'scroll' , overflowY:'scroll' , display:'flex' , flexFlow:'column nowrap' \r\n        }}\r\n      >\r\n        {\r\n        [...MembersArr.keys()].map(key=>{ ++count;\r\n         \r\n          return(\r\n          <div className=\"RemoveMember-Container\"  id={`RemoveMember${count}`} onClick={()=>{ \r\n            console.log(\"User\",UserName,\" is going be deleted from roomID\",key);\r\n            removeMember = key;\r\n            document.getElementById(\"RemoveMember-ChatWindow-Output\").innerHTML=`Remove ${MembersArr.get(key).UserId}`\r\n           }}>\r\n            <div className='MemberPic'>\r\n              <img src={MembersArr.get(key).Img} />\r\n            </div>\r\n            <div className='RemoveMemberName'>\r\n                {/* {MembersArr.get(key).Name} */}\r\n                {key}\r\n                </div>\r\n                \r\n          </div>\r\n          );\r\n        })\r\n    }\r\n      </Box>\r\n      </div>\r\n      <p id=\"RemoveMember-ChatWindow-Output\" ></p>\r\n      <div className='SubmitRemoveMember'>\r\n      <Button variant=\"contained\"\r\n      sx={{\r\n        marginTop:'10px'\r\n      }}\r\n        onClick={()=>{\r\n          deleteMember();\r\n        }}\r\n        >Remove Member</Button>\r\n      </div>\r\n    </Paper>\r\n  );\r\n}\r\n\r\nexport default ChatWindow_RemoveMember;","import * as React from 'react';\r\nimport './ChatWindowOptions.css';\r\nimport ChatWindow_AddMember from './ChatWindow_AddMember';\r\nimport ChatWindow_RemoveMember from './ChatWindow_RemoveMember';\r\n\r\n\r\n\r\nconst ChatWindowOptionsContainer = ({SelectedOption,Members,ActiveRoomId}) =>{\r\n    console.log(\"Room Id Passed to CHat Window Options Container is ->\",ActiveRoomId);\r\n  if(SelectedOption===\"Search\"){\r\n     var x = document.getElementById('ChatSearchBarContainer');\r\n     if(x) x.classList.remove('Hide');\r\n  }\r\n  else{\r\n    var x = document.getElementById('ChatSearchBarContainer');\r\n    if(x) x.classList.add('Hide');  }\r\n\r\n   React.useEffect(()=>{\r\n    window.addEventListener('click',function(){\r\n\r\n    });\r\n\r\n    return()=>{\r\n      window.removeEventListener('click',function(){\r\n        console.log(\"Removed\");\r\n      });\r\n    }\r\n   },[])\r\n\r\nconst MembersList = Members;\r\n    console.log(\"In Member Open Options->\");\r\n    console.log(\"Members passed to Open Options in Member Section are->\",Members);\r\n    console.log(\"IN Open _> Selcted Option is \",SelectedOption);\r\n\r\n    return(\r\n<div className='MemberOptions-Wrapper' id=\"MemberOptions-Wrapper\" >\r\n      <div className={ \"ChatWindow-AddMember-Container\" +(SelectedOption===\"Add Member\"? \"\" : \" Hide\") }>\r\n        <ChatWindow_AddMember  ActiveRoomId={ActiveRoomId} Members={MembersList}   />\r\n      </div>\r\n      <div className={ \"ChatWindow-RemoveMember-Container\" +(SelectedOption===\"Remove Member\"? \"\" : \" Hide\") }>\r\n       <ChatWindow_RemoveMember ActiveRoomId={ActiveRoomId} Members={Members} />\r\n      </div>\r\n    </div>\r\n    );\r\n};\r\n\r\n\r\nexport default ChatWindowOptionsContainer;","import * as React from 'react';\r\nimport IconButton from '@mui/material/IconButton';\r\nimport Menu from '@mui/material/Menu';\r\nimport MenuItem from '@mui/material/MenuItem';\r\nimport MoreVertIcon from '@mui/icons-material/MoreVert';\r\nimport ChatWindowOptionsContainer from './ChatWindowOptionsContainer';\r\n\r\n\r\nconst ChatWindowOptions = ({Members,ActiveRoomId}) =>{\r\n    console.log(\"Room Id Passed to Chat Window Options is ->\",ActiveRoomId);\r\n  const [SelectedOption,setSelectedOption] = React.useState(\"None\");\r\nconst options = [\r\n  'None',\r\n  \"Search\",\r\n  'Add Member',\r\n  'Remove Member'\r\n];\r\nvar MembersList =Members;\r\nconsole.log(\"Members List in Chat Window Options is \",MembersList);\r\nconst ITEM_HEIGHT = 48;\r\n  const [anchorEl, setAnchorEl] = React.useState(null);\r\n  const [open , setOpen] = React.useState();\r\n  const handleClick = (event) => {\r\n    setAnchorEl(event.currentTarget);\r\n    console.log(\"Selected option is \",event);\r\n    setOpen(true);\r\n  };\r\n  const handleClose = () => {\r\n    setAnchorEl(null);\r\n  setOpen(false);\r\n  };\r\n\r\nconsole.log(\"In Chat Window Options->\");\r\nconsole.log(\"Chat Window Members->\",Members);\r\n\r\n  return (\r\n    <div>\r\n    <div>\r\n      <IconButton\r\n        aria-label=\"more\"\r\n        id=\"long-button\"\r\n        aria-controls={open ? 'long-menu' : undefined}\r\n        aria-expanded={open ? 'true' : undefined}\r\n        aria-haspopup=\"true\"\r\n        onClick={handleClick}\r\n      >\r\n        <MoreVertIcon />\r\n      </IconButton>\r\n      <Menu\r\n        id=\"long-menu\"\r\n        MenuListProps={{\r\n          'aria-labelledby': 'long-button',\r\n        }}\r\n        anchorEl={anchorEl}\r\n        open={open}\r\n        onClose={handleClose}\r\n        PaperProps={{\r\n          style: {\r\n            maxHeight: ITEM_HEIGHT * 4.5,\r\n            width: '20ch',\r\n          },\r\n        }}\r\n      >\r\n        {options.map((option) => (\r\n          <MenuItem key={option} selected={option === anchorEl} onClick={()=>{setSelectedOption(option); setOpen(false);}}>\r\n            {option}\r\n          </MenuItem>\r\n        ))}\r\n      </Menu>\r\n    </div>\r\n    <ChatWindowOptionsContainer  SelectedOption={SelectedOption}  Members={Members}  ActiveRoomId={ActiveRoomId}  />\r\n    </div>\r\n\r\n    \r\n\r\n\r\n  );\r\n}\r\n\r\nexport default ChatWindowOptions;","import React, { useState,useEffect } from \"react\";\r\nimport './Posts.css'\r\nimport ChevronRightIcon from '@mui/icons-material/ChevronRight';\r\nimport ChevronLeftIcon from '@mui/icons-material/ChevronLeft';\r\n\r\n\r\n\r\nconst Post = ({Media,Sender,PostText,TimeStamp,PostId}) => {\r\n\r\n\r\nconst [slide,setslide] = useState(0);\r\n  useEffect(()=>{\r\n    var x = document.getElementById(`Post-Media-Element-${PostId}-${slide}`)\r\n    console.log(\"element to be scrolled to\",x);\r\n        var container = document.getElementById(`Post-MediaHolder-${PostId}`);\r\n        if(x)\r\n      var len=x.offsetLeft;\r\n        container.scrollLeft=len;\r\n  },[slide])\r\n\r\n\r\n  var MediaArr = Media;\r\n  if(!MediaArr) MediaArr=[];\r\n  console.log(MediaArr)\r\n    return(\r\n<div className=\"Post-Wrapper\">\r\n   \r\n        \r\n        <div className=\"Post-Content\">\r\n            <div className=\"Post-AvatarAndNameWrapper\">\r\n            <img className=\"Post-Sender-ProfilePic\" src=\"https://previews.123rf.com/images/grandeduc/grandeduc1603/grandeduc160300008/54330729-reaper-moon-rising-3d-render-of-cratered-skull-moon-in-night-sky.jpg\" alt=\"FTLI\"    >\r\n                \r\n            </img>\r\n            <p className=\"Post-Sender-Name\">\r\n            {Sender}\r\n        </p>\r\n        </div>\r\n            <div className=\"Post-TextAndMediaAndName-Holder\">\r\n           \r\n            <div className=\"Post-TextAndMedia-Holder\" >\r\n                <div className=\"Post-MediaHolder\" id={`Post-MediaHolder-${PostId}`} >\r\n               <ChevronLeftIcon \r\n               sx={{\r\n                position:'absolute', justifySelf:'end' , color:'white' , marginLeft:'0px' , \r\n                alignSelf:'center' , width:60 , height:50 , cursor:'pointer'\r\n               }}\r\n               onClick={(e)=>{\r\n                var media = document.getElementById(`Post-MediaHolder-${PostId}`);\r\n                if(media)  media = media.getElementsByClassName(\"Post-Media-Element\");\r\n                console.log(\"media in post->\",media.length);\r\n                if(slide===0) setslide(media.length-1);\r\n                else\r\n                setslide((slide-1));\r\n               }}\r\n               />\r\n               {\r\n                MediaArr.map((img,index)=>(<img className=\"Post-Media-Element\" id={`Post-Media-Element-${PostId}-${index}`} src={img} key={index} alt=\"Error\" /> ))\r\n               }\r\n               <ChevronRightIcon \r\n               sx={{\r\n                position:'absolute', justifySelf:'end' , color:'white' , marginLeft:'295px' , \r\n                alignSelf:'center' , width:60 , height:50 , cursor:'pointer'\r\n               }}\r\n               onClick ={(e)=>{\r\n                var media = document.getElementById(`Post-MediaHolder-${PostId}`);\r\n                console.log(`Post-MediaHolder-${PostId}`,media);\r\n\r\n                if(media)  media = media.getElementsByClassName(\"Post-Media-Element\");\r\n                console.log(\"media in post->\",media.length);\r\n                setslide((slide+1)%media.length);\r\n               }}\r\n               />\r\n                 \r\n                </div>\r\n                \r\n                <p className=\"PostText\">{PostText}</p>\r\n                </div>\r\n            </div>\r\n        </div>\r\n        <p className=\"Post-TimeStamp\"></p>\r\n   \r\n</div>\r\n    )\r\n\r\n}\r\n\r\nexport default Post;","import React, { useRef } from 'react'\r\nimport ChatScopeSwitch from '../ChatScopeSwitch/ChatScopeSwitch.js';\r\nimport './ChatWindow.css';\r\nimport ProfileDisplay from '../ProfileDisplay&Rooms/ProfileDisplay&Rooms.js' \r\nimport Message from '../Message/Message.js'\r\nimport { useState,useEffect } from 'react';\r\nimport axios from 'axios'; \r\nimport TextField from '@mui/material/TextField';\r\nimport ArrowBackIcon from '@mui/icons-material/ArrowBack';\r\nimport { IoMdSend ,IoMdMore} from \"react-icons/io\";\r\nimport IconButton from '@mui/material/IconButton';\r\nimport Menu from '@mui/material/Menu';\r\nimport MenuItem from '@mui/material/MenuItem';\r\nimport MoreVertIcon from '@mui/icons-material/MoreVert';\r\nimport RoomHeaderOptions from '../Mui/RoomHeaderOptions.js';\r\nimport { useParams } from 'react-router-dom';\r\nimport Pusher from 'pusher-js'; \r\nimport mongoose from 'mongoose';\r\nimport { io } from \"socket.io-client\";\r\nimport ChatWindowOptions from '../Additional_Components/ChatWindowOptions.js';\r\nimport Paper from '@mui/material/Paper';\r\nimport InputBase from '@mui/material/InputBase';\r\nimport Divider from '@mui/material/Divider';\r\n\r\nimport MenuIcon from '@mui/icons-material/Menu';\r\nimport SearchIcon from '@mui/icons-material/Search';\r\nimport DirectionsIcon from '@mui/icons-material/Directions';\r\nimport Post from '../Posts/Posts.js';\r\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome'\r\nimport fontawesome from '@fortawesome/fontawesome'\r\nimport AttachFileIcon from '@mui/icons-material/AttachFile';\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nvar NewRoomName=\"\";\r\nvar roomtype =\"quick\";\r\n  //  \"start\": \"concurrently \\\"react-scripts start\\\" \\\" cd.. && cd server && npm start\\\"\",\r\n\r\nvar userid =\"\";\r\nvar UserName=\"\";\r\nvar name=\"\";\r\n\r\nconst tempid=new mongoose.Types.ObjectId().toString();\r\nconst ChatWindow = () =>{\r\n\r\nconst [Rooms,setRooms] = useState(new Map());\r\nconst [Members,setMembers] = useState(new Map());\r\nconst [ActiveRoomId,setActiveRoomId] = useState();\r\nconst[ xArray ,setxArray]=useState([ActiveRoomId]);\r\nconst[UserType,setUserType] = useState(\"Quick\");\r\nconst [n,setN] = useState(1);\r\nconst [UserId , setUserId] = useState(\"\");\r\nconst [RoomId, setRoomId] = useState(\"\"); \r\nconst [Messages, setMessages] = useState(new Map());\r\nconst [LastMessage,setLastMessage]=useState(new Map());\r\nconst [ActiveWindow,setActiveWindow] = useState(\"Both\");\r\nconst [TypedMessage, setTypedMessage] = useState(\"\");\r\nconst [OptionState,setOptionState] = useState(null);\r\nconst [RoomCount,setRoomCount] = useState(0);\r\nconst [msg, setMsg] = useState();\r\nconst [Lastmsg, setLastMsg] = useState();\r\nconst [room, setroom] = useState();\r\nconst [delmsg,setdelmsg]=useState();\r\nconst [delmem,setdelmem] = useState();\r\nconst [delroom,setdelroom] = useState();\r\nconst [mem,setmem] = useState();\r\nconst [flag,setflag] = useState();\r\nconst [flag2,setflag2] = useState();\r\nconst [flagLoadMessages,setFlagLoadMessages] = useState(true);\r\nconst [DisplayDataType,setDisplayDataType] = useState(\"MainMessages\");\r\nconst [Posts,setPosts] = useState(new Map());\r\nconst [Queries,setQueries] = useState(new Map());\r\nconst [post,setpost] = useState();\r\nconst [query,setquery]  = useState();\r\nconst [FullRoomData,setFullRoomData] = useState(new Map());\r\nconst [PostImages, setPostImages] = useState();\r\nconst [ActiveMembers,setActiveMembers] = useState(new Map());\r\n\r\nconst params= useParams();\r\nuserid= params.UserName;\r\n\r\nUserName=userid;\r\nif(!UserName){\r\n  window.location.replace(`/Login`);\r\n}\r\nconsole.log(UserName , \"userName->\");\r\nuseEffect(()=>{\r\n  \r\n  const AccessToken = localStorage.getItem(`User ${UserName}`);\r\n  console.log(\"fetched from local->\")\r\n    console.log(AccessToken);\r\n  axios.get('/Server/Auth/TokenValidate', {headers:{\"authorization\" : `Bearer ${AccessToken}`  }}).then(Response=>{\r\n     \r\n   if(Response.data.resval === \"TokenVerified\")\r\n   { \r\n       \r\n        console.log(\"Token Verified\");\r\n   }\r\n   else{\r\n     window.location.replace(`/Login`);\r\n   }\r\n console.log(Response.data); \r\n \r\n}).catch(error=>{\r\n console.log(error);\r\n});\r\n\r\n},[]);\r\n\r\nuseEffect(()=>{\r\n  if(UserName){\r\nconsole.log(\"Loading Rooms as new Room detected or page loaded->\");\r\n  axios.get(`/Server/Rooms/Room/load/${UserName}`)\r\n  .then(res=>{\r\n     console.log(\"Rooms Loaded\",res.data);\r\n     res.data.forEach(room=>{\r\n       Rooms.set(room.RoomId,{\r\n        Status:\"Active\",\r\n        Name:room.Name\r\n       });\r\n     });\r\n     setRooms(new Map(Rooms));\r\n     setflag(true);\r\n  })\r\n  .catch(err=>{\r\n    console.log(\"Error in Loading rooms\",err);\r\n  });\r\n\r\n  }\r\n},[room]);\r\n\r\nuseEffect(()=>{\r\n  if(ActiveRoomId){\r\n    setMessages(new Map(Messages.clear()));\r\n   \r\n   axios.get(`/Server/Rooms/Message/load/${ActiveRoomId}`)\r\n  .then(res=>{\r\n    console.log(\"Messages of room loaded\",res.data);\r\n    const Temp=res.data;\r\n    if(Temp){\r\n    for(const message of Temp){\r\n      Messages.set(message.MessageId,message);\r\n    }\r\n  }\r\n    setMessages(new Map(Messages));\r\n    setFlagLoadMessages(!flagLoadMessages);\r\n  })\r\n  .catch(err=>{\r\n    console.log(\"Err in loading messages\",err);\r\n  });\r\n\r\n\r\n  setPosts(new Map(Posts.clear()));\r\n\r\n   axios.get(`/Server/Rooms/load/Posts/${ActiveRoomId}`)\r\n  .then(res=>{\r\n    console.log(\"Posts Fetched ->\",res.data);\r\n    const Temp=res.data;\r\n    if(Temp){\r\n    for(const post of Temp){\r\n      Posts.set(post.PostId,post);\r\n    }\r\n  }\r\n    setPosts(new Map(Posts));\r\n  })\r\n  .catch(err=>{\r\n    console.log(\"Error While fetching Posts\",err);\r\n  });\r\n   \r\n  setQueries(new Map(Queries.clear()));\r\n   axios.get(`/Server/Rooms/Queries/load/${ActiveRoomId}`)\r\n  .then(res=>{\r\n    console.log(\"Queries Fetched ->\",res.data);\r\n    const Temp=res.data;\r\n    if(Temp){\r\n    for(const query of Temp){\r\n      Queries.set(query.QueryId,query);\r\n    }\r\n  }\r\n    setQueries(new Map(Queries));\r\n  })\r\n  .catch(err=>{\r\n    console.log(\"Error While fetching Queries\",err);\r\n  });\r\n\r\n}\r\n},[ActiveRoomId]);\r\n\r\nuseEffect(()=>{\r\n  if(ActiveRoomId){\r\n  setMembers(new Map(Members.clear()));\r\n    axios.get(`/Server/Rooms/Members/load/${ActiveRoomId}`)\r\n    .then(res=>{\r\n       \r\n      console.log(\"Members of room loaded\",res.data);\r\n      const Temp=res.data;\r\n      if(Temp){\r\n      for(const member of Temp){\r\n        Members.set(member.UserId,member);\r\n      }\r\n    }\r\n      setMembers(new Map(Members));\r\n    })\r\n    .catch(err=>{\r\n      console.log(\"Err in loading members\",err);\r\n    });\r\n  }\r\n},[ActiveRoomId]); \r\n\r\n\r\nuseEffect(()=>{\r\n  setFullRoomData(new Map());\r\n  axios.get(`/Server/Rooms/GetFullRooms/${UserName}`)\r\n  .then(res=>{\r\n    console.log(\"Full Rooms and thier Data Fetched->\",res.data);\r\n    const temp = res.data;\r\n    \r\n    temp.forEach(room=>{\r\n      \r\n       const msgMap = new Map();\r\n       const PostsMap = new Map();\r\n       const QueriesMap = new Map();\r\n       const MemMap = new Map();\r\n       room.Messages.forEach(msg=>{\r\n        msgMap.set(msg.MessageId,msg);\r\n       });\r\n       room.Posts.forEach(pos=>{\r\n         PostsMap.set(pos.PostId,pos);\r\n       });\r\n       room.Queries.forEach(que=>{\r\n        QueriesMap.set(que.QueryId,que);\r\n       });\r\nroom.Members.forEach(mem=>{\r\n     MemMap.set(mem.UserId,mem);\r\n});\r\n\r\n       FullRoomData.set(room.RoomId , {\r\n        RoomId:room.RoomId,\r\n        Name: room.Name,\r\n        Messages : msgMap,\r\n        Posts: PostsMap,\r\n        Queries : QueriesMap,\r\n        RoomType:room.RoomType,\r\n        Members:MemMap\r\n       });\r\n    });\r\n    console.log(\"Full Room Data is ->\",FullRoomData);\r\n    setFullRoomData(new Map(FullRoomData));\r\n  })\r\n  .catch(err=>{\r\n    console.log(\"Error in fecthing full data of rooms of user->\");\r\n    console.log(err);\r\n  })\r\n},[Rooms])\r\n\r\n\r\nuseEffect(()=>{\r\n  if(DisplayDataType===\"Messages\"){\r\n    \r\n  }\r\n  else if(DisplayDataType === \"Posts\"){\r\n\r\n  }\r\n  else if(DisplayDataType === \"Queries\"){\r\n\r\n  }\r\n},[DisplayDataType])\r\n\r\n\r\n\r\n\r\n\r\nconst [socket,setSocket] = useState(null);\r\nconsole.log(\"Socket is\",socket);\r\nuseEffect(()=>{\r\n  const port = process.env.fakePort;\r\n  console.log(\"window hostname\",window.location.hostname);\r\n  if(socket===null)\r\n  setSocket(io());\r\n \r\n \r\n  \r\n  \r\n    if(socket){\r\n    socket.on(\"connect\",()=>{\r\n      console.log(socket.id);\r\n     var roomsArray=[];\r\n[...Rooms].map(([key,value])=> roomsArray.push(key));\r\nroomsArray.push(UserName);\r\nconsole.log(roomsArray);\r\nsocket.emit(\"joinRoom\",roomsArray); \r\n});\r\n\r\n    }\r\n\r\n    return ()=>{\r\n      if(socket){\r\n      socket.on('disconnect', () => { \r\n        console.log(\"disccoented\");\r\n        socket.removeAllListeners();  \r\n        socket.off(\"connect\");\r\n       \r\n     });\r\n     \r\n    }\r\n    \r\n  }\r\n},[flag]);\r\n\r\n\r\nuseEffect(()=>{\r\n  if(socket){\r\nconsole.log(\"socket Id is \",socket.id);\r\n   \r\n   socket.on('update',data=>{\r\n     if(Object.keys(data).includes(\"MessageId\")){\r\n       setMsg(data);\r\n       setLastMsg(data);\r\n       console.log(\"new  message in socket\",data);\r\n     }\r\n     else if(Object.keys(data).includes(\"UserId\")){\r\n       setmem(data);\r\n       console.log(\"new  member in socket\",data);\r\n     }\r\n     else if(Object.keys(data).includes(\"PostId\")){\r\n      setpost(data);\r\n      console.log(\"new  post in socket\",data);\r\n     }\r\n     else if(Object.keys(data).includes(\"QueryId\")){\r\n      setquery(data);\r\n      console.log(\"new  Query in socket\",data);\r\n     }\r\n   });\r\n\r\n  socket.on('insert',data=>{\r\n    console.log(\"New Room Detected in Socket\",data)\r\n    if(data){\r\n      socket.emit(\"joinRoom\",[data.RoomId,UserName]);\r\n    }\r\n    setroom(data);\r\n  });\r\n\r\n  \r\n    \r\n  socket.on(\"disconnected\",data=>{\r\n    if(data && Members.has(data)){\r\n      ActiveMembers.delete(data);\r\n      setActiveMembers(new Map(ActiveMembers));\r\n    console.log(\"Socket User Left fired\",data);\r\n    }\r\n   })\r\n   socket.on('connected',data=>{\r\n      if(data){\r\n        setActiveMembers(new Map(ActiveMembers.set(data,Members.get(data))));\r\n      }\r\n      console.log(\" USer joined room->\",data);\r\n   })\r\n  \r\n    socket.on(\"MemberStatusResponse\",data=>{\r\n      console.log(\"Active Members in Room are \",data);\r\n      const AM =new Map();\r\n      ActiveMembers.clear();\r\n      if(Array.isArray(data)){\r\n        data.forEach(userId=>{\r\n            ActiveMembers.set(userId,Members.get(userId));\r\n        })\r\n      }\r\n      setActiveMembers(new Map(ActiveMembers));\r\n    })\r\n\r\n  }\r\nreturn ()=>{\r\n  if(socket){\r\n  \r\n    console.log(\"disccoented\");\r\n    socket.removeAllListeners();  \r\n    \r\n     socket.disconnect();\r\n}\r\n}\r\n\r\n},[socket]);\r\n\r\n\r\nuseEffect(()=>{\r\n  if(socket){\r\n  socket.emit(\"MemberStatus\",ActiveRoomId);\r\n  }\r\n},[ActiveRoomId])\r\nconsole.log(\"Active Members->\",ActiveMembers);\r\n\r\nvar QuickRoomCount=1;\r\n const createRoom= async()=>{\r\n  var NewRoomId = new mongoose.Types.ObjectId();\r\n  NewRoomId=NewRoomId.toString();\r\n  console.log(\"Creating Room with->\",NewRoomId);\r\n  socket.emit(\"joinRoom\",NewRoomId);\r\n  // await axios.post(`/Room/create/${UserName}`,\r\n  //   {\r\n  //     RoomId:NewRoomId,\r\n  //     Name:NewRoomName,\r\n  //     Members : [{\r\n  //       UserId:UserName,\r\n  //       Name:name,\r\n  //       RoomId:NewRoomId\r\n  //     }],\r\n  //     Messages:[],\r\n  //     RoomType : \"Auth\"\r\n  // })\r\n  // .then(res=>{\r\n  //   console.log(\"created new room\",res.data);\r\n   \r\n  // })\r\n  // .catch(err=>{\r\n  //   console.log(\"Err in creating room\",err);\r\n  // });\r\n}\r\nvar User_Name=\"Temp Name\";\r\nconst sendMessage =async()=>{\r\n  var NewMessage = Messages.get(\"Message-TypeComponent\");\r\n  console.log(\"Debugging FileUpload-> New Message->\",NewMessage);\r\n  if(NewMessage && Messages.has(\"Message-TypeComponent\")){\r\n   Messages.delete(\"Message-TypeComponent\");\r\n   var files = document.getElementById(\"Message-ImageAttach-Input\");\r\n   var MessageText = document.getElementById(\"Message-TypeArea\").value;\r\n   var NewMessageId = new mongoose.Types.ObjectId().toString();\r\n   if(!MessageText) MessageText=\"\";\r\n   console.log(\"Debugging FileUpload-> Files->\",files.file , files.files);\r\n   \r\n   const formData  = new FormData();\r\n   if(files && files.files){\r\n    console.log(\"Debugging FileUpload-> Files Found->\",files.files);\r\n    const NewFiles=[];\r\n    var x = files.files;\r\n    console.log(\"Debug->\",x,Array.isArray(x),Object.keys(x))\r\n    \r\n    Object.keys(x).forEach(index=>{\r\n      formData.append(\"image\",x[index],x[index].path);\r\n     })\r\n    \r\n    console.log(\"Debugging FileUpload->  Type of ->\",)\r\n  //  formData.append(\"image\",NewFiles);\r\n    console.log(\"Debugging FileUpload-> New Files Array->\",NewFiles);\r\n  }\r\n  var date  = Date.now();\r\n   formData.append(\"Sender\",UserName);\r\n   formData.append(\"MessageText\",MessageText);\r\n   formData.append(\"MessageId\",NewMessageId);\r\n   formData.append(\"RoomId\",ActiveRoomId);\r\n   formData.append(\"TimeStamp\",date)\r\n   for (var pair of formData.entries()) {\r\n    console.log(\"Debug-> FormData->\",pair[0]+ ', ' + pair[1]); \r\n}\r\n   await axios.post(`/Server/Rooms/Message/add/${ActiveRoomId}`,\r\n   formData,\r\n   {\r\n    headers: {\r\n      'Content-Type': 'multipart/form-data'\r\n    },\r\n  }\r\n   )\r\n   .then(res=>{\r\n    console.log(\"Message Insertion Response->\",res);\r\n    document.getElementById(\"Message-TypeArea\").value=\"\";\r\n   })\r\n   .catch(err=>{\r\n    console.log(\"Message Insertion Error->\",err);\r\n   })\r\n  }\r\n}\r\n\r\nconst sendPost = async() =>{\r\n  var NewPost = Posts.get(\"Post-TypeComponent\");\r\n  console.log(\"Debugging FileUpload-> New Post->\",NewPost);\r\n  if(NewPost && Posts.has(\"Post-TypeComponent\")){\r\n   Posts.delete(\"Post-TypeComponent\");\r\n   var files = document.getElementById(\"Post-ImageAttach-Input\");\r\n   var PostText = document.getElementById(\"Post-TypeArea\").value;\r\n   var NewPostId = new mongoose.Types.ObjectId().toString();\r\n   if(!PostText) PostText=\"\";\r\n   console.log(\"Debugging FileUpload-> Files->\",files.files);\r\n   \r\n   const formData  = new FormData();\r\n   if(files && files.files && files.files.length>0){\r\n    console.log(\"Debugging FileUpload-> Files Found->\",files.files);\r\n    const NewFiles=[];\r\n    var x = files.files;\r\n    console.log(\"Debug->\",x,Array.isArray(x),Object.keys(x))\r\n    Object.keys(x).forEach(index=>{\r\n     formData.append(\"image\",x[index],x[index].path);\r\n    })\r\n    console.log(\"Debugging FileUpload->  Type of ->\",)\r\n  //  formData.append(\"image\",NewFiles);\r\n    console.log(\"Debugging FileUpload-> New Files Array->\",NewFiles);\r\n  }\r\n   formData.append(\"Sender\",UserName);\r\n   formData.append(\"PostText\",PostText);\r\n   formData.append(\"PostId\",NewPostId);\r\n   formData.append(\"RoomId\",ActiveRoomId);\r\n   for (var pair of formData.entries()) {\r\n    console.log(\"Debug-> FormData->\",pair[0]+ ', ' + pair[1]); \r\n}\r\n   await axios.post(`/Server/Rooms/add/Post/${ActiveRoomId}`,\r\n   formData,\r\n   {\r\n    headers: {\r\n      'Content-Type': 'multipart/form-data'\r\n    },\r\n  }\r\n   )\r\n   .then(res=>{\r\n    console.log(\"Post Insertion Response->\",res);\r\n    document.getElementById(\"Post-TypeArea\").value=\"\";\r\n\r\n   })\r\n   .catch(err=>{\r\n    console.log(\"Post Insertion Error->\",err);\r\n   })\r\n\r\n\r\n\r\n  }\r\n  \r\n}\r\n\r\n\r\n\r\n\r\nconst addUser=async(NewUser)=>{\r\n  await axios.post(`/Server/Rooms/Room/add/User/${ActiveRoomId}`,\r\n  {\r\n   UserId:NewUser.UserId,\r\n   Name:NewUser.Name,\r\n   RoomId:ActiveRoomId\r\n  })\r\n  .then(res=>{\r\n    console.log(\"Added new Member\",res.data);\r\n  })\r\n  .catch(err=>{\r\n    console.log(\"Err in adding Member\",err);\r\n  });\r\n}\r\n\r\nconst deleteUser = async(UserName,RoomId) =>{\r\n\r\n await axios.post(`/Server/Rooms/Room/Delete/Member/${RoomId}/${UserName}`)\r\n.then(res=>{\r\n  console.log(res.data);\r\n}).catch(err=>{\r\n  console.log(err);\r\n});\r\n\r\n}\r\n//   window.addEventListener('beforeunload',function(e){\r\n//     e.preventDefault();\r\n//     deleteUser(UserName,ActiveRoomId);\r\n  \r\n// })\r\n\r\n// window.addEventListener('unload',function(e){\r\n//   e.preventDefault();\r\n//   navigator.sendBeacon(`/Room/Delete/Member/${ActiveRoomId}/${UserId}`)\r\n//   deleteUser(UserId,ActiveRoomId);\r\n// });\r\n\r\n\r\nconst FilterRooms = () =>{\r\n  var FilterQuery = document.getElementById(\"RoomSearchBar\").value;\r\n  console.log(\"search filter is \",FilterQuery);\r\n  var list = document.getElementById(\"Room-Window\");\r\n   list = list.getElementsByClassName(\"RoomComponentWrapperDiv\");\r\n  console.log(\"Rooms list for litering are->\",list);\r\n    for(var i=0;i<list.length;i++){\r\n      const x = list[i].getElementsByClassName(\"User-ProfileName\")[0];\r\n      console.log(\"Sub Div in filtering loop\",x.childNodes[0].nodeValue);\r\n      const y = x.childNodes[0].nodeValue;\r\n      if(y.toLowerCase().includes(FilterQuery.toLocaleLowerCase())){\r\n      list[i].style.display=\"\";\r\n       console.log(\"Element checking for filterting in remove Room\",y);\r\n      }\r\n      else\r\n      list[i].style.display=\"none\";\r\n    }\r\n}\r\n\r\n\r\n\r\n\r\nuseEffect(() => {\r\n\r\n \r\n  //    //Pusher.logToConsole = true;\r\n      var pusher = new Pusher('d3a40ccf8c32cd64d3ac', {\r\n       cluster: 'ap2',\r\n       encrypted:true,\r\n     });\r\n  \r\n     var deleteChannel = pusher.subscribe('delete');\r\n     deleteChannel.bind('Message',function(data){console.log(\"Pusher -> delete message\",data);\r\n     if(data){ console.log(ActiveRoomId,data.RoomId);\r\n       if(data.RoomId===ActiveRoomId)\r\n       setdelmsg(data);\r\n     }\r\n     });\r\n     deleteChannel.bind('Member',function(data){console.log(\"Pusher -> delete member\",data);\r\n       if(data){ \r\n        if(data.RoomId===ActiveRoomId){\r\n          console.log(\"Member deleted\");\r\n         setdelmem(data);\r\n        }\r\n       }\r\n     });\r\n     deleteChannel.bind('Room',function(data){\r\n      if(data){\r\n        if(data.UserId===UserName)\r\n        setdelroom(data);\r\n      }\r\n    });\r\n  \r\n  // var MessageChannel = pusher.subscribe('Messages');\r\n  // MessageChannel.bind('inserted', function(data) {\r\n  //  setLastMsg(data);\r\n  //  if(ActiveRoomId===data.RoomId) setMsg(data);\r\n  //   console.log(\"Triggered pusher-> Message added\",data);\r\n  //   console.log(\"Active ->\",ActiveRoomId,\"newmessage ->\", data.RoomId, ActiveRoomId===data.RoomId);\r\n    \r\n    \r\n  // });\r\n  \r\n    \r\n  // MessageChannel.bind('deleted', function(data) {\r\n   \r\n  //   console.log(\"Triggered pusher-> Message deleted\",data);\r\n   \r\n  //  //iterate and set all messages as data is full messages array\r\n  // });\r\n  \r\n  // MessageChannel.bind('updated', function(data) {\r\n    \r\n  //   console.log(\"Triggered pusher-> Message updated\",data);\r\n  //   setLastMsg(data);\r\n   \r\n  // });\r\n  \r\n  // var MemberChannel = pusher.subscribe(\"Members\");\r\n  // MemberChannel.bind('inserted', function(data) {\r\n  //   setmem(data);\r\n  //   console.log(\"Triggered pusher-> Member added\",data);\r\n    \r\n  // });\r\n  \r\n  // MemberChannel.bind('deleted', function(data) {\r\n  //   console.log(\"Triggered pusher-> Member deleted\",data);\r\n  //  //iterate and set\r\n  //  setdelmem(data);\r\n  // });\r\n  \r\n  // MemberChannel.bind('updated', function(data) {\r\n  //  setmem(data);\r\n  //   console.log(\"Triggered pusher-> Member updated\",data);\r\n   \r\n  // });\r\n  \r\n  // var RoomChannel = pusher.subscribe('Rooms');\r\n\r\n  // RoomChannel.bind('inserted', function(data) {\r\n  //   if(data){\r\n  //   console.log(\"Triggered pusher-> Room added\",data.NewRoom);\r\n  //  setroom(data.NewRoom);\r\n  // }\r\n  // });\r\n  \r\n  // RoomChannel.bind('deleted', function(data) {\r\n  //   console.log(\"Triggered pusher-> Room deleted\",data);\r\n  //   setdelroom(data);\r\n  // });\r\n  \r\n  // RoomChannel.bind('updated', function(data) {\r\n  //   setroom(data);\r\n  //   console.log(\"Triggered pusher-> Room updated\",data);\r\n    \r\n    \r\n  // });\r\n  // return () => {\r\n  //   pusher.unsubscribe(\"Messages\");\r\n  //   pusher.unsubscribe(\"Members\");\r\n  //   pusher.unsubscribe(\"Rooms\");\r\n  // };\r\n  return ()=>{\r\n    pusher.unsubscribe('delete');\r\n  };\r\n  \r\n}, []);\r\n\r\n\r\n\r\n\r\nuseEffect(() => {console.log(\"New Message useEffect fired  \",msg);\r\nif (msg) { console.log(\"New Message is \",msg);\r\nconst temp=msg;\r\nif(ActiveRoomId===msg.RoomId)\r\nsetMessages(new Map(Messages.set(temp.MessageId,temp)));\r\nif(msg.Sender===UserName) scrollToBottom();\r\n//setFullRoomData(new Map(FullRoomData.get(msg.RoomId).Messages.set(msg.MessageId,msg)));\r\nconsole.log(\"After inserting new Message the Full Room Data is ->\",FullRoomData);\r\n}\r\n}, [msg]);\r\n\r\nuseEffect(() => {console.log(\"New Post useEffect fired  \",msg);\r\nif (post) { console.log(\"New Post is \",post);\r\nconst temp=post;\r\nif(ActiveRoomId===post.RoomId)\r\nsetPosts(new Map(Posts.set(temp.PostId,temp)));\r\nif(post.Sender===UserName) scrollToBottom();\r\n//setFullRoomData(new Map(FullRoomData.get(post.RoomId).Posts.set(post.PostId,post)));\r\nconsole.log(\"After inserting new Post the Full Room Data is ->\",FullRoomData);\r\n}\r\n}, [post]);\r\n\r\nuseEffect(() => {console.log(\"New Query useEffect fired  \",msg);\r\nif (query) { console.log(\"New Query is \",query);\r\nconst temp=query;\r\nif(ActiveRoomId===query.RoomId)\r\nsetQueries(new Map(Queries.set(temp.QueryId,temp)));\r\nif(query.Sender===UserName) scrollToBottom();\r\n//setFullRoomData(new Map(FullRoomData.get(query.RoomId).Queries.set(query.QueryId,query)));\r\nconsole.log(\"After inserting new Query the Full Room Data is ->\",FullRoomData);\r\n}\r\n}, [query]);\r\n\r\n\r\n\r\n\r\nuseEffect(() => {console.log(\"New LastMessage useEffect fired  \",Lastmsg);\r\nif(Lastmsg){\r\nconst temp=Lastmsg;\r\nsetLastMessage(new Map(LastMessage.set(temp.RoomId,temp.MessageText)));\r\n //if (Lastmsg) setLastMessage(new Map(LastMessage.set(Lastmsg.RoomId,Lastmsg)));\r\n}\r\n}, [Lastmsg]);\r\n\r\nuseEffect(() => {console.log(\"New Member useEffect fired  \",mem);\r\nif (mem) { console.log(\"New Member is \",mem);\r\nconst temp=mem;\r\nsetMembers(new Map(Members.set(temp.UserId,temp)));\r\n}\r\n}, [mem]);\r\n\r\n\r\nuseEffect(() => {\r\nif (room) {\r\n  const temp=room;\r\n  console.log(\"New Room is\",room);\r\n  console.log(\"New Room Id is\",temp.RoomId);\r\n   setRooms(new Map(Rooms.set(temp.RoomId,{status:\"inactive\", Name:temp.Name})));\r\n  \r\n//    if(room.UserId === UserName) setRooms(new Map(Rooms.set(room.RoomId,\"inactive\")));\r\n}\r\n}, [room]);\r\n\r\nuseEffect(() => {console.log(\"delete Message useEffect fired  \",msg);\r\nif (delmsg && Messages.has(delmsg.RoomId)) { console.log(\"delete Message is \",delmsg);\r\nconst temp=delmsg;\r\nif(ActiveRoomId===temp.RoomId){\r\nMessages.delete(temp.MessageId);\r\nconst X=Messages;\r\nsetMessages(new Map(X));\r\n}\r\n}\r\n}, [delmsg]);\r\n\r\nuseEffect(() => {\r\nif(delmem && Members.has(delmem.UserId)){\r\n  \r\nconst temp=delmem;\r\nconsole.log(\"testting delete member roomid\",ActiveRoomId===delmem.RoomId)\r\nif(ActiveRoomId===temp.RoomId) {\r\n  console.log(\"delete member useEffect fired  \",delmem.UserId);\r\n  Members.delete(temp.UserId);\r\n  const X=Members;\r\nsetMembers(new Map(X));\r\n}\r\n //if (Lastmsg) setLastMessage(new Map(LastMessage.set(Lastmsg.RoomId,Lastmsg)));\r\n}\r\n}, [delmem]);\r\n\r\nuseEffect(() => {\r\nif (delroom) {\r\n  console.log(\"delete room use effect fired for \", delroom);\r\n  const temp=delroom;\r\n  if(Rooms.has(temp.RoomId)){\r\n    Rooms.delete(temp.RoomId);\r\n    const X=Rooms;\r\n    setRooms(new Map(X));}\r\n    //    if(room.UserId === UserName) setRooms(new Map(Rooms.set(room.RoomId,\"inactive\")));\r\n}\r\n}, [delroom]);\r\n\r\n\r\nuseEffect(()=>{\r\nwindow.addEventListener('resize',function(e){ console.log(\"Debug Active Window fired-> current window\",ActiveWindow);\r\nconst wid = window.innerWidth;\r\nconst hei = window.innerHeight;\r\n\r\nvar x =document.getElementById(\"Room-Container-Wrapper\");\r\n  var y = this.document.getElementById(\"Chat-Container-Wrapper\");\r\nif(wid<=600){  console.log(\"Debug Active Window -> Active Window now chatwindow -> width<600px && window===both\");\r\n   if(x && !x.classList.contains(\"Hide\") && y && !y.classList.contains(\"Hide\")){\r\n    x.classList.add(\"Hide\");\r\n   }\r\n}\r\nelse if(wid>600){ \r\n  \r\n  if(x && x.classList.contains(\"Hide\")) x.classList.remove(\"Hide\");\r\n  if(y && y.classList.contains(\"Hide\")) y.classList.remove(\"Hide\");\r\nconsole.log(\"Debug Active Window -> Active Window now Both -> width>600px\")\r\n}\r\n});\r\nreturn()=>{\r\n window.removeEventListener(\"resize\",function(){\r\n\r\n })\r\n};\r\n},[])\r\nconsole.log(\"Debug -> Active Window =\",ActiveWindow);\r\n\r\nconsole.log(\"Members before rendering are\",Members);\r\nconsole.log(\"Rooms before rendering are\",Rooms);\r\n   const loadMessages= (RoomId) =>{\r\n      setActiveRoomId(RoomId);\r\n   }\r\n   var count=0;\r\nconsole.log(LastMessage);\r\n    var width,height;\r\n\r\n\r\n    const messagesEndRef = useRef(null);\r\n\r\n    const scrollToBottom = () => {\r\n      messagesEndRef.current?.scrollIntoView({ behavior: \"smooth\" });\r\n      var objDiv = document.getElementById(\"MessagesScrollDownDiv\");\r\nobjDiv.scrollIntoView(false);\r\n    }\r\n    useEffect(() => {\r\n      scrollToBottom();\r\n    }, [flagLoadMessages]);\r\n \r\n    var ChatWindowOptionsX=null;\r\n    \r\n\r\n  const ScrollToBottomCustom =(div,Container)=>{\r\n    if(div){\r\n      var x= div.offsetTop;\r\n     var y = Container;\r\n      if(y){\r\n        y.scrollTop = x;\r\n      }\r\n    }\r\n  }\r\n\r\n       \r\n    return (\r\n     <div className=\"ContentWrapper\">\r\n       \r\n       <div className ={\"Room-container-Wrapper\" + (ActiveWindow===\"ChatWindow\"? \" Hide\" : \"\")} id=\"Room-Container-Wrapper\"  >\r\n        \r\n        <div className=\"Room-container\">\r\n        \r\n        <div className=\"Room-Header-Wrapper\">\r\n            <div className=\"Room-Header-scopeSwitch\">\r\n               <ChatScopeSwitch>\r\n                   \r\n                </ChatScopeSwitch>\r\n           </div>\r\n           <div className=\"Room-Header-contents\">\r\n           <Paper\r\n      component=\"form\"\r\n      sx={{ p: '2px 4px', display: 'flex', alignItems: 'center', width: '89%' }}\r\n    >\r\n      <div className='RoomSearchBarContainer' id=\"RoomSearchBarContainer\">\r\n      <InputBase\r\n      id=\"RoomSearchBar\"\r\n      onChange={(e)=>{\r\n        FilterRooms();\r\n      }}\r\n        sx={{ ml: 1, flex: 1 }}\r\n        placeholder=\"Search Rooms\"\r\n        inputProps={{ 'aria-label': 'Search Rooms' }}\r\n      />\r\n      <IconButton  sx={{ p: '10px' , flex:0.3 }} aria-label=\"search\">\r\n        <SearchIcon />\r\n      </IconButton>\r\n      </div>\r\n      <Divider sx={{ height: 28, m: 0.5 }} orientation=\"vertical\" />\r\n      <RoomHeaderOptions Rooms={Rooms} socket={socket} />\r\n    </Paper>\r\n             {/* <IoMdMore className=\"OptionsMenu-RoomHeader\"/> */}\r\n             \r\n             \r\n           </div>\r\n           </div>\r\n           <div className=\"Room-Window-Wrapper\">\r\n           <div className=\"Room-Window\" id=\"Room-Window\">\r\n              \r\n        {/*  add rooms */}\r\n        {\r\n      \r\n          [...Rooms.keys()].map(roomid=>{\r\n           \r\n            return(\r\n           <div className=\"RoomComponentWrapperDiv\" id=\"RoomComponentWrapperDiv\"\r\n           onClick={()=>{ \r\n            setActiveRoomId(roomid);\r\n            document.getElementById(\"Chat-Header-Details-Name\").innerHTML=Rooms.get(roomid).Name;\r\n                    width = document.body.clientWidth;\r\n                    var x =document.getElementById(\"Room-Container-Wrapper\");\r\n                    var y = document.getElementById(\"Chat-Container-Wrapper\")\r\n                     console.log(\"Active RoomID is \",ActiveRoomId , roomid, ActiveRoomId===roomid);\r\n                   if(width<=600){\r\n                    if(y && y.classList.contains(\"Hide\")) y.classList.remove(\"Hide\");\r\n                    if(x && !x.classList.contains(\"Hide\")) x.classList.add(\"Hide\");\r\n                   }\r\n            }}\r\n                   >\r\n           <ProfileDisplay ProfileName={Rooms.get(roomid).Name} LastMessage={LastMessage.get(roomid)}/>\r\n           </div>\r\n            );\r\n          })\r\n        }\r\n            </div>\r\n           </div>\r\n\r\n        </div>\r\n        </div>\r\n\r\n        <div className={\"Chat-container-Wrapper\" +(ActiveWindow===\"RoomWindow\"? \" Hide\":\"\") }\r\n        id=\"Chat-Container-Wrapper\"\r\n        >\r\n            <div className=\"Chat-Container\">\r\n        <div className=\"Chat-Header-Wrapper\">\r\n            <div className=\"Chat-Header\">\r\n              <div className='backArrow-ChatHeader'>\r\n                <ArrowBackIcon className={\"BackArrow-ChatWindow BackArrowRes backArrow-ChatHeader\"} \r\n                onClick={()=>{\r\n                  var y =document.getElementById(\"Room-Container-Wrapper\");\r\n                    var x = document.getElementById(\"Chat-Container-Wrapper\")\r\n                     var wid = document.body.clientWidth;\r\n                   if(wid<=600){\r\n                    if(y && y.classList.contains(\"Hide\")) y.classList.remove(\"Hide\");\r\n                    if(x && !x.classList.contains(\"Hide\")) x.classList.add(\"Hide\");\r\n                   }\r\n                \r\n                }}\r\n                sx={{\r\n                  width:'40px' , height:'30px'\r\n                }}\r\n                />\r\n                </div>\r\n                <div className=\"RoomDetails-Wrapper-ChatHeader\"\r\n                 onClick={(e)=>{\r\n                  console.log(\"Debug Window-> Room Clicked \");\r\n                   var ChatContainer=document.getElementById(\"Chat-Container-Wrapper\");\r\n                   if(ChatContainer){\r\n                     ChatContainer.classList.add(\"Hide\");\r\n                     var RoomDetails = document.getElementById(\"RoomDetails-FullDetails\");\r\n                     if(RoomDetails){\r\n                      RoomDetails.classList.remove(\"Hide\");\r\n                     }\r\n                   }\r\n                 }}\r\n                >\r\n                  <img className='RoomDetails-Avatar-ChatHeader'  src=\"\" alt=\"error\" />\r\n                  <div className='RoomDetails-Name-ChatHeader' id=\"Chat-Header-Details-Name\" >\r\n                    \r\n                  </div>\r\n                </div>\r\n                <div className='RoomOptions-ChatHeader'>\r\n                  <div className='RoomDetails-ChatHeader'>\r\n                  </div>\r\n                  <div className='Search-ChatHeader'>\r\n                  <Paper\r\n                    component=\"form\"\r\n                    sx={{ p: '2px 4px', display: 'flex', alignItems: 'center', width: '89%' ,marginRight:'5vw'}}\r\n                    >\r\n                   <div className='ChatSearchBarContainer' id=\"ChatSearchBarContainer\">\r\n                   <InputBase\r\n                       id=\"ChatSearchBar\"\r\n                       onChange={()=>{\r\n                        //FilterChat()\r\n                       }}\r\n                       sx={{ ml: 1, flex: 0.8 }}\r\n                       placeholder=\"Search Chat\"\r\n                       inputProps={{ 'aria-label': 'Search Chat' }}\r\n      />                 \r\n      <IconButton  sx={{ p: '10px' , flex:0.3 }} aria-label=\"search\">\r\n        <SearchIcon \r\n        \r\n        />\r\n      </IconButton>\r\n      </div>\r\n      <Divider sx={{ height: 28, m: 0.5 }} orientation=\"vertical\" />\r\n      <ChatWindowOptions Members={Members}  ActiveRoomId={ActiveRoomId}  />\r\n      <Divider sx={{ height: 28, m: 0.5 }} orientation=\"vertical\" />\r\n      <MenuIcon\r\n      onClick={(e)=>{\r\n         var x= document.getElementById(\"ChatDisplayTypes-Container\");\r\n         if(x){\r\n          if(x.classList.contains(\"Hide\")){\r\n            x.classList.remove(\"Hide\");\r\n          }\r\n          else x.classList.add(\"Hide\");\r\n         }\r\n      }}\r\n      sx={{\r\n        cursor:'pointer'\r\n      }}\r\n      id=\"MenuIcon-ChatHeader-OtherDataOptions\"\r\n      className=\"MenuIcon-ChatHeader-OtherDataOptions\"\r\n      />        \r\n    </Paper>    \r\n                  </div>{console.log(\"Active Room id is->\",ActiveRoomId)}\r\n                \r\n                </div>  \r\n                </div>\r\n            </div>\r\n            {/* {\r\n              ActiveRoomId===undefined? \r\n              <img src=\"https://images2.minutemediacdn.com/image/upload/c_fill,w_720,ar_16:9,f_auto,q_auto,g_auto/shape/cover/sport/istock-579416094-f09b85324ce8504d3b8b1ba983134e8d.jpg\"/>\r\n              : <p></p>\r\n            } */}\r\n            <div className=\"Chat-Box-Wrapper\">\r\n            <div className={\"Chat-Box\" + (DisplayDataType===\"MainMessages\"? \" MessageChatBox\" : \" Hide\") } \r\n            id=\"ChatBox-Messages-Id\"\r\n            >\r\n               {console.log(Messages.size)}\r\n            {   \r\n                 [...Messages.keys()].map(message=>{  var time =new Date(Messages.get(message).TimeStamp);\r\n                  time= time.toString().split(' ');\r\n                  console.log(\"Time parts\",time);\r\n                 time=time[1]+ \" \" + time[2] + \" \"+ time[3] + \" \" + time[4] ;\r\n                   return(\r\n                     <Message\r\n                     own={Messages.get(message).Sender===UserName}\r\n                     MessageText={Messages.get(message).MessageText}\r\n                     Name={Messages.get(message).Sender}\r\n                     TimeStamp={time}\r\n                     Media={Messages.get(message).Media}\r\n                     />\r\n                   );\r\n                 })\r\n            }\r\n            <div ref={messagesEndRef} id=\"MessagesScrollDownDiv\" />\r\n            </div>\r\n            \r\n            <div className={\"Chat-Box\" + (DisplayDataType===\"MainPosts\"? \" PostChatBox\" : \" Hide\") }\r\n            id=\"ChatBox-Posts-Id\"\r\n            >\r\n              {\r\n                [...Posts.keys()].map(key=>{\r\n                  var time =new Date(Posts.get(key).TimeStamp);    \r\n                  time= time.toString().split(' ');\r\n                  console.log(\"Time parts\",time);\r\n                 time=time[1]+ \" \" + time[2] + \" \"+ time[3] + \" \" + time[4] ;\r\n                  return(\r\n                    <Post Sender={Posts.get(key).Sender}  Media={Posts.get(key).Media} TimeStamp={time}  \r\n                    PostText={Posts.get(key).PostText} PostId={key}\r\n                    />\r\n                  )\r\n                })\r\n              }\r\n            \r\n            <div ref={messagesEndRef} id=\"PostsScrollDownDiv\" />\r\n            </div>\r\n\r\n            <div className={\"Chat-Box\" + (DisplayDataType===\"MainQueries\"? \" QueryChatBox\" : \" Hide\") }\r\n            id=\"ChatBox-Queries-Id\"\r\n            >\r\n               {console.log(Messages.size)}\r\n            { \r\n                 [...Messages.keys()].map(message=>{  var time =new Date(Messages.get(message).TimeStamp);\r\n                  time= time.toString();\r\n                 \r\n                   return(\r\n                     <Message \r\n                     own={Messages.get(message).Sender===UserName}\r\n                     MessageText={Messages.get(message).MessageText}\r\n                     Name={Messages.get(message).Sender}\r\n                     TimeStamp={time}\r\n                     />\r\n                   );\r\n                 })\r\n            }\r\n            <div ref={messagesEndRef} id=\"QueriesScrollDownDiv\" />\r\n            </div>\r\n               \r\n            \r\n            <div className='Members-Wrapper-ChatContainer'>\r\n              <p className='WhiteTextOnDarkBG H2'>\r\n              Members:  </p>\r\n              <div className='MembersList-ChatContainer'>\r\n              {\r\n                    [...ActiveMembers.keys()].map(key=>{ if(!Members.has(key)) return null\r\n                      return(\r\n                        <div className='MemberWrapper-ChatContainer'>\r\n                      <div className=\"MemberName-ChatContainer ActiveMember-Online\">\r\n                         {key} \r\n                      </div>\r\n                      <div className='MemberStatus-ChatContainer'>\r\n\r\n                      </div>\r\n                    </div>\r\n                      )\r\n                    })\r\n                  }\r\n\r\n\r\n                {\r\n                  [...Members.keys()].map(key=>{ if(ActiveMembers.has(key)) return null;\r\n                    return(\r\n                    <div className='MemberWrapper-ChatContainer'>\r\n                      <div className=\"MemberName-ChatContainer\">\r\n                        {key}\r\n                      </div>\r\n                      <div className='MemberStatus-ChatContainer'>\r\n\r\n                      </div>\r\n                    </div>\r\n                    )\r\n                  })\r\n                }\r\n              </div>\r\n             </div>\r\n            </div>\r\n           \r\n        <div className={\"TypeArea\" + (DisplayDataType===\"MainMessages\"? \"\" : \" Hide\") }>\r\n          <div className='TypeBox-Container'>\r\n          <TextField\r\n          id=\"Message-TypeArea\"\r\n          label=\"Message\"\r\n          placeholder=\"Message\"\r\n          multiline \r\n          maxRows={3}\r\n          onChange={(e)=>{\r\n            var val=document.getElementById(\"Message-TypeArea\").value;\r\n                      if(val.length > 0){\r\n                        var files = document.getElementById(\"Message-ImageAttach-Input\");\r\n                        var media=[];\r\n                        if(files && files.files && Object.keys(files.files).length>0){\r\n                          Object.keys(files.files).forEach(index=>{\r\n                            console.log(\"Debug MessageMedia->\",files.files[index],files.files)\r\n                            media.push(URL.createObjectURL(files.files[index]));\r\n                          })\r\n                        }\r\n                        setMessages(new Map(Messages.set(\"Message-TypeComponent\", {\r\n                          Sender:UserName,\r\n                          MessageText:val,\r\n                          Media:media,\r\n                          TimeStamp:Date.now().toString(),\r\n                        })))\r\n                      }\r\n                      else{Messages.delete(\"Message-TypeComponent\")\r\n                        setMessages(new Map(Messages))\r\n                      }\r\n                      ScrollToBottomCustom(document.getElementById(\"MessagesScrollDownDiv\"),\r\n                      document.getElementById(\"ChatBox-Messages-Id\"));\r\n                     \r\n          }}\r\n          \r\n          onKeyPress={(ev) => {\r\n            if (ev.key === 'Enter') {\r\n             if(ev.shiftKey){ sendMessage();\r\n              ev.preventDefault();\r\n             }\r\n            }\r\n          }}\r\n          sx={{width:'90%',margin:'10px', maxWidth:'700px'  , boxShadow:4}}\r\n        /> \r\n          \r\n          \r\n          </div>\r\n          <div className='TypeArea-SendButton'>\r\n                   <IoMdSend  \r\n                   className='Chat-SendButton'\r\n                   \r\n                   onClick={()=>{ \r\n                    var typedMssg = document.getElementById('Message-TypeArea').value;\r\n                    console.log(\"Submitted Message  is \" , typedMssg);\r\n                       if(typedMssg.length>0)\r\n                       sendMessage();\r\n                       else alert(\"Type atleast 1 Letter\");\r\n                   }}  \r\n                   \r\n                   />\r\n                   <label htmlFor=\"Message-ImageAttach-Input\">\r\n                     <input accept=\"image/*\" id=\"Message-ImageAttach-Input\" multiple type=\"file\"   className=\"AttachFile-InputBar\" \r\n                     onChange={(e)=>{\r\n                      var val=document.getElementById(\"Message-TypeArea\").value;\r\n                      if(val.length > 0){\r\n                        var files = document.getElementById(\"Message-ImageAttach-Input\");\r\n                        var media=[];\r\n                        if(files && files.files && Object.keys(files.files).length>0){\r\n                          Object.keys(files.files).forEach(index=>{\r\n                            console.log(\"Debug MessageMedia->\",files.files[index],files.files)\r\n                            media.push(URL.createObjectURL(files.files[index]));\r\n                          })\r\n                        }\r\n                        setMessages(new Map(Messages.set(\"Message-TypeComponent\", {\r\n                          Sender:UserName,\r\n                          MessageText:val,\r\n                          Media:media,\r\n                          TimeStamp:Date.now().toString(),\r\n                        })))\r\n                      }\r\n                      else{Messages.delete(\"Message-TypeComponent\")\r\n                        setMessages(new Map(Messages))\r\n                      }\r\n                      ScrollToBottomCustom(document.getElementById(\"MessagesScrollDownDiv\"),\r\n                      document.getElementById(\"ChatBox-Messages-Id\"));\r\n                     }}\r\n                     />\r\n                    <AttachFileIcon \r\n                    sx={{\r\n                      width:'40px' , height:'35px' ,  cursor:'pointer'\r\n                    }}\r\n                                />\r\n                       </label>\r\n          </div>\r\n        </div>\r\n         \r\n        <div className={\"TypeArea\" + (DisplayDataType===\"MainPosts\"? \"\" : \" Hide\") }>\r\n          <div className='TypeBox-Container'>\r\n          <TextField\r\n          id=\"Post-TypeArea\"\r\n          label=\"Post\"\r\n          placeholder=\"Post\"\r\n          multiline \r\n          maxRows={3}\r\n          onChange={(e)=>{\r\n            var val=document.getElementById(\"Post-TypeArea\").value;\r\n            if(val.length > 0){\r\n              var files = document.getElementById(\"Post-ImageAttach-Input\");\r\n              var media=[];\r\n              if(files && files.files && Object.keys(files.files).length>0){\r\n                Object.keys(files.files).forEach(index=>{\r\n                  console.log(\"Debug PostMedia->\",files.files[index],files.files)\r\n                  media.push(URL.createObjectURL(files.files[index]));\r\n                })\r\n              }\r\n              setPosts(new Map(Posts.set(\"Post-TypeComponent\", {\r\n                Sender:UserName,\r\n                PostText:val,\r\n                Media:media,\r\n                TimeStamp:Date.now().toString(),\r\n              })))\r\n            }\r\n            else{Posts.delete(\"Post-TypeComponent\")\r\n              setPosts(new Map(Posts))\r\n            }\r\n            ScrollToBottomCustom(document.getElementById(\"PostsScrollDownDiv\"),\r\n            document.getElementById(\"ChatBox-Posts-Id\"));\r\n          }}\r\n          \r\n          onKeyPress={(ev) => {\r\n            if (ev.key === 'Enter') {\r\n             if(ev.shiftKey){ sendPost();\r\n              ev.preventDefault();\r\n             }\r\n            }//import { FontAwesomeIcon } from \"react-icons/fa\";\r\n          }}\r\n          sx={{margin:'10px', width:'70vw'  , boxShadow:4}}\r\n        />   \r\n          </div>\r\n\r\n\r\n                   <div className='TypeArea-SendButton'>\r\n                   <IoMdSend  \r\n                   className='Chat-SendButton'\r\n                   \r\n                   onClick={()=>{ \r\n                    var typedMssg = document.getElementById('Post-TypeArea').value;\r\n                    console.log(\"Submitted Post  is \" , typedMssg);\r\n                       if(typedMssg.length>0)\r\n                       sendPost();\r\n                       else alert(\"Type atleast 1 Letter\");\r\n                   }}  \r\n                   \r\n                   />\r\n                    <label htmlFor=\"Post-ImageAttach-Input\">\r\n                     <input accept=\"image/*\" id=\"Post-ImageAttach-Input\" multiple type=\"file\"   className=\"AttachFile-InputBar\" \r\n                     onChange={(e)=>{\r\n                      var val=document.getElementById(\"Post-TypeArea\").value;\r\n                      if(val.length > 0){\r\n                        var files = document.getElementById(\"Post-ImageAttach-Input\");\r\n                        var media=[];\r\n                        if(files && files.files && Object.keys(files.files).length>0){\r\n                          Object.keys(files.files).forEach(index=>{\r\n                            console.log(\"Debug PostMedia->\",files.files[index],files.files)\r\n                            media.push(URL.createObjectURL(files.files[index]));\r\n                          })\r\n                        }\r\n                        setPosts(new Map(Posts.set(\"Post-TypeComponent\", {\r\n                          Sender:UserName,\r\n                          PostText:val,\r\n                          Media:media,\r\n                          TimeStamp:Date.now().toString(),\r\n                        })))\r\n                      }\r\n                      else{Posts.delete(\"Post-TypeComponent\")\r\n                        setPosts(new Map(Posts))\r\n                      }\r\n                      ScrollToBottomCustom(document.getElementById(\"PostsScrollDownDiv\"),\r\n                      document.getElementById(\"ChatBox-Posts-Id\"));\r\n                     }}\r\n                     />\r\n                    <AttachFileIcon \r\n                    sx={{\r\n                      width:'40px' , height:'35px' ,  cursor:'pointer'\r\n                    }}\r\n                                />\r\n                       </label>\r\n          </div>\r\n         \r\n         \r\n        </div>\r\n\r\n        <div className={\"TypeArea\" + (DisplayDataType===\"MainQueries\"? \"\" : \" Hide\") }>\r\n          <div className='TypeBox-Container'>\r\n          <TextField\r\n          id=\"Query-TypeArea\"\r\n          label=\"Query\"\r\n          placeholder=\"Query\"\r\n          multiline \r\n          maxRows={3}\r\n          \r\n          \r\n          onKeyPress={(ev) => {\r\n            if (ev.key === 'Enter') {\r\n             if(ev.shiftKey){ sendMessage();\r\n              ev.preventDefault();\r\n             }\r\n            }\r\n          }}\r\n          sx={{width:'90%',margin:'10px', maxWidth:'700px'  , boxShadow:4}}\r\n        /> \r\n          \r\n          \r\n          </div>\r\n          <div className='TypeArea-SendButton'>\r\n                   <IoMdSend  \r\n                   className='Chat-SendButton'\r\n                   \r\n                   onClick={()=>{ \r\n                    var typedMssg = document.getElementById('Message-TypeArea').value;\r\n                    console.log(\"Submitted Message  is \" , typedMssg);\r\n                       if(typedMssg.length>0)\r\n                       sendMessage();\r\n                       else alert(\"Type atleast 1 Letter\");\r\n                   }}  \r\n                   \r\n                   />\r\n          </div>\r\n        </div>\r\n\r\n        </div>\r\n        </div>\r\n\r\n        <div className='RoomDetails-FullDetails Hide'\r\n            id=\"RoomDetails-FullDetails\"\r\n            >\r\n            <div className='RoomInside-DetailsHeader'>\r\n            <ArrowBackIcon className={\"BackArrow-ChatWindow BackArrowRes backArrow-ChatHeader\"} \r\n                onClick={()=>{\r\n                  console.log(\"debug window-> back arrow clicked->\");\r\n                 var x =document.getElementById(\"RoomDetails-FullDetails\");\r\n                 if(x)  x.classList.add(\"Hide\");\r\n                 x=document.getElementById(\"Chat-Container-Wrapper\");\r\n                 if(x) x.classList.remove(\"Hide\");\r\n                }}\r\n                sx={{\r\n                  width:'40px' , height:'30px'\r\n                }}\r\n                />\r\n            </div> \r\n            Members : \r\n             <div className='RoomInside-MembersList'>\r\n             \r\n             {\r\n              [...ActiveMembers.keys()].map(mem=>{ if(!Members.has(mem)) return null\r\n                return(\r\n                  <div className=\"Member-InsideDetailsList-Wrapper\">\r\n                    <img className=\"MemberAvatar-InsideDetailsList\"  src=\"\" alt=\"error\" />\r\n                    <div className='MemberName-InsideDetailsList ActiveMember-Online'>\r\n                      {mem}\r\n                    </div>\r\n                  </div>\r\n                )\r\n              })\r\n             }\r\n              {\r\n                [...Members.keys()].map(key=>{if(ActiveMembers.has(key)) return null;\r\n                  return(\r\n                    <div className=\"Member-InsideDetailsList-Wrapper\">\r\n                      <img className=\"MemberAvatar-InsideDetailsList\"  src=\"\" alt=\"error\" />\r\n                      <div className='MemberName-InsideDetailsList'>\r\n                        {key}\r\n                      </div>\r\n                    </div>\r\n                  )\r\n                })\r\n              }\r\n             </div>\r\n            </div>\r\n\r\n\r\n        <div className='ChatDisplayTypes-Container Hide' id=\"ChatDisplayTypes-Container\">\r\n             ____Room Board\r\n          <div className = \"Fit-Text Container NoOverFlow ChatDisplayTypes-TypeHolder\">\r\n            <p className='NormalHeader NoOverFlow'>Messages</p>\r\n                  <div className=\"SubContentsListContainer\">\r\n                    <div className=\"SubContentName Highlight5\"\r\n                    onClick={(e)=>{\r\n                      var x =document.getElementById(\"ChatDisplayTypes-Container\");\r\n                      if(x){\r\n                        if(!(x.classList.contains(\"Hide\"))) x.classList.add(\"Hide\");\r\n                      }\r\n                      setDisplayDataType(\"MainMessages\");\r\n                    }}\r\n                    >Main Messages</div>\r\n                    </div>\r\n                  </div>\r\n                  \r\n                  <div className = \"Fit-Text Container NoOverFlow ChatDisplayTypes-TypeHolder\">\r\n            <p className='NormalHeader NoOverFlow'>Posts</p>\r\n                  <div className=\"SubContentsListContainer\">\r\n                    <div className=\"SubContentName Highlight5\"\r\n                    onClick={(e)=>{\r\n                      var x =document.getElementById(\"ChatDisplayTypes-Container\");\r\n                      if(x){\r\n                        if(!(x.classList.contains(\"Hide\"))) x.classList.add(\"Hide\");\r\n                      }\r\n                      setDisplayDataType(\"MainPosts\");\r\n                    }}\r\n                    >Main Posts</div>\r\n                    </div>\r\n                  </div>\r\n                 \r\n                  <div className = \"Fit-Text Container NoOverFlow ChatDisplayTypes-TypeHolder\">\r\n            <p className='NormalHeader NoOverFlow'>Queries</p>\r\n                  <div className=\"SubContentsListContainer\">\r\n                    <div className=\"SubContentName Highlight5\"\r\n                    onClick={(e)=>{\r\n                      var x =document.getElementById(\"ChatDisplayTypes-Container\");\r\n                      if(x){\r\n                        if(!(x.classList.contains(\"Hide\"))) x.classList.add(\"Hide\");\r\n                      }\r\n                      setDisplayDataType(\"MainQueries\");\r\n                    }}\r\n                    >Main Queries</div>\r\n                    </div>\r\n                  </div>\r\n         \r\n       \r\n        </div>\r\n        </div>\r\n    );\r\n}\r\n\r\nexport default ChatWindow;","import React from \"react\";\r\nimport './Home.css';\r\n\r\nconst Home = ()=>{\r\n  const x = new Map();\r\n  x.set(5,[4]); x.get(5).push(8)\r\n  console.log(\"Debug MAp\",x.get(5));\r\n  console.log(\"In Home Page\");\r\n    return(\r\n    <div className=\"Home-Wrapper\">\r\n      <div className=\"Home-Page\">\r\n          <div className=\"Login-Wrapper\">\r\n              <div className=\"Login-Container\">\r\n                Home\r\n              </div>\r\n          </div>\r\n\r\n      </div>\r\n    </div>\r\n    );\r\n}\r\n\r\nexport default Home;\r\n\r\n","import React ,{useState,useEffect} from \"react\";\r\nimport './Login.css';\r\nimport Box from '@mui/material/Box';\r\nimport TextField from '@mui/material/TextField';\r\nimport Button from '@mui/material/Button';\r\nimport { FcGoogle } from \"react-icons/fc\";\r\nimport { SiFacebook } from \"react-icons/si\";\r\nimport { AiOutlineMail } from \"react-icons/ai\";\r\nimport axios from \"axios\";\r\nimport { Route } from \"react-router\";\r\nimport { useNavigate } from \"react-router-dom\";\r\nimport { NavLink } from \"react-router-dom\";\r\nimport mongoose from \"mongoose\";\r\nimport { IoMdDisc } from \"react-icons/io\";\r\n\r\nconst Login = () => {\r\n\r\n    const [UserName, setUserName] = useState(\"\");\r\n    const [Password, setPassword] = useState(\"\");\r\n    const [SecretKey, setSecretKey] = useState(\"\");\r\n    const [AuthStatus, setAuthStatus] = useState(\"NotValid\");\r\n    const [Message, SetMessage] = useState(\"\");\r\n    const [AccessToken, setAccessToken] = useState(\"\");\r\n    const CheckUserName = (e) => {\r\n      setUserName(e.target.value);\r\n      console.log(UserName);\r\n    };\r\n    const CheckPassword = (e) => {\r\n      setPassword(e.target.value);\r\n      console.log(UserName);\r\n    };\r\n    const CheckSecretKey = (e) => {\r\n      setSecretKey(e.target.value);\r\n      console.log(SecretKey);\r\n    };\r\n  \r\n    const [UserType, setUserType] = useState(\"\");\r\n    async function submitLogin(e) {\r\n      console.log(UserName);\r\n      console.log(\"Password is \",Password);\r\n      var CheckMessage = \"\";\r\n      await axios\r\n        .post(\r\n          `/Server/Auth/User/Login`,\r\n          {\r\n                UserName: UserName,\r\n                Password: Password,\r\n              }\r\n        )\r\n        .then((Response) => { \r\n          console.log(Response.data);\r\n          if (\r\n            typeof Response.data.resval === \"string\" ||\r\n            Response.data.resval instanceof String\r\n          )\r\n            SetMessage(Response.data.resval);\r\n          const accessToken = Response.data.token;\r\n          if (accessToken) {\r\n            console.log(\"token from login->\");\r\n            console.log(Response.data.token);\r\n            try {\r\n              console.log(UserName);\r\n              localStorage.setItem(`User ${UserName}`, accessToken);\r\n            } catch (error) {\r\n              console.log(\"error->\");\r\n              console.log(error);\r\n            }\r\n            setAccessToken(localStorage.getItem(`User ${UserName}`));\r\n          }\r\n          if (Response.data.resval) SetMessage(Response.data.resval);\r\n          CheckMessage = Response.data.resval;\r\n  \r\n          console.log(AccessToken);\r\n        })\r\n  \r\n        .catch((error) => {\r\n          console.log(\"error while Logging in\");\r\n          console.log(error);\r\n        });\r\n  \r\n      const token = localStorage.getItem(`User ${UserName}`);\r\n      console.log(\"fetched from local->\");\r\n      console.log(token);\r\n      if (token && CheckMessage === \"Matched\")\r\n        await axios\r\n          .get(\"/Server/Auth/TokenValidate\", {\r\n            headers: { authorization: `Bearer ${token}` },\r\n          })\r\n          .then((Response) => {\r\n            if (Response.data.resval === \"TokenVerified\") {\r\n              window.location.replace(`/Account/${UserName}`);\r\n            }\r\n            console.log(Response.data);\r\n          })\r\n          .catch((error) => {\r\n            console.log(error);\r\n          });\r\n    }\r\n    console.log(\"state after token validation \");\r\n    console.log(AccessToken);\r\n  \r\n\r\n\r\n\r\n  const createQuickRoom = async() =>{\r\n   var tempUserId = new mongoose.Types.ObjectId().toString();\r\n   tempUserId = tempUserId.toString();\r\n   var roomId = document.getElementById(\"QuickRoom-Login\");\r\n   if(roomId) roomId = roomId.value;\r\n   var tempName = document.getElementById(\"QuickRoom--UsersName-Login\");\r\n   if(tempName) tempName= tempName.value;\r\n   if(roomId.length<1 || tempName.length<1){\r\n   var xx= document.getElementById(\"Login-HelperText-QuickRoom\");\r\n   xx.innerHTML =\"Name and RoomId should be atLeast 1 length long\";\r\n   }\r\n   else\r\n    window.location.replace(`QuickRoom/QuickUser/${roomId}/${tempUserId}/${tempName}`);\r\n  }\r\n\r\n\r\n\r\n\r\n\r\n  useEffect(()=>{\r\n\r\n   var quickButton = document.getElementById(\"QuickRoom-LoginButton\");\r\n    document.addEventListener('click',function(e){\r\n      var container = document.getElementById(\"QuickRoom-Login-Div\");\r\n      console.log(\"Event of click->\",e);\r\n    if (e.target!==container && !container.contains(e.target) && e.target!==quickButton) \r\n    {console.log(\"Detected click outside quick room div\")\r\n      if(container && !container.classList.contains(\"Hide\"))\r\n      container.classList.add(\"Hide\");\r\n    }\r\n})\r\n  },[])\r\n\r\n\r\n\r\n\r\n  return (\r\n    <div className=\"LoginPage-Wrapper\">\r\n   <div className=\"Login-Wrapper\">\r\n       <div className='Login-Container'>\r\n           <div className='User-Pass-Container'>\r\n           <TextField id=\"outlined-basic\" \r\n           label=\"UserName\" \r\n           variant=\"outlined\" \r\n           onChange={(e) => {\r\n            CheckUserName(e);\r\n          }}\r\n          inputProps={{\r\n            style: { fontSize: 18, wordSpacing: 17, lineHeight: 1.5 },\r\n          }}\r\n          InputLabelProps={{\r\n            style: { fontSize: 18, wordSpacing: 17, lineHeight: 1.5 },\r\n          }}\r\n          sx={{boxShadow: 4 }}\r\n           />\r\n           \r\n           <TextField\r\n          id=\"outlined-password-input\"\r\n          label=\"Password\"\r\n          type=\"password\"\r\n          inputProps={{\r\n            style: { fontSize: 18, wordSpacing: 17, lineHeight: 1.5 },\r\n          }}\r\n          InputLabelProps={{\r\n            style: { fontSize: 18, wordSpacing: 17, lineHeight: 1.5 },\r\n          }}\r\n          onChange={(e) => {\r\n            CheckPassword(e);\r\n          }}\r\n          sx={{  boxShadow: 4,  }}\r\n          \r\n        />\r\n           </div>\r\n               <div className='Login-Options'>\r\n\r\n               <FcGoogle className=\"LoginOption-Icons\" />\r\n               <SiFacebook className=\"LoginOption-Icons\" />\r\n               <AiOutlineMail className=\"LoginOption-Icons\" />\r\n           </div>\r\n           <div className='OtherRoom-Wrapper'>\r\n           <div className='QuickRoom-Container'>\r\n           <Button variant=\"text\"\r\n                   id=\"QuickRoom-LoginButton\"\r\n                   onClick={()=>{\r\n                  const ele=document.getElementById(\"QuickRoom-Login-Div\")\r\n                  if(ele){ ele.style.position=\"fixed\";\r\n                  ele.classList.remove(\"Hide\");\r\n                   }\r\n                  //const ele2=document.getElementById(\"QuickRoom-LoginButton\").style.display=\"none\";\r\n                  \r\n                   }\r\n                  }\r\n           >Quick Room</Button>\r\n           <div className=\"Hide Show-Login\" id=\"QuickRoom-Login-Div\" >\r\n\r\n           <TextField\r\n          id=\"QuickRoom-Login\"\r\n          label=\"Quick Room ID\"\r\n          type=\"search\"\r\n          variant=\"standard\"\r\n          className=\"QuickRoom-Login\"\r\n        />\r\n        <TextField\r\n          id=\"QuickRoom--UsersName-Login\"\r\n          label=\"User Name\"\r\n          type=\"search\"\r\n          variant=\"standard\"\r\n          className=\"QuickRoom-Login\"\r\n        />\r\n         <Button variant=\"contained\"\r\n         id=\"QuickLogin-Button\"\r\n   className=\"LoginSubmit\"\r\n   onClick={(e) => {\r\n    var id = document.getElementById(\"QuickRoom-Login\");\r\n    if(id) id=id.value;\r\n    var name= document.getElementById(\"QuickRoom--UsersName-Login\");\r\n    if(name) name= name.value;\r\n    if(id.length<1 || id.length>20)  document.getElementById(\"Login-HelperText-QuickRoom\").innerHTML=\"Length Of Room Id should be >1 and <21\";\r\n    else if(name.length<1 || name.length>20)  document.getElementById(\"Login-HelperText-QuickRoom\").innerHTML=\"Length Of User Name should be >1 and <28\";\r\n    else\r\n    createQuickRoom(e);\r\n  }}\r\n  sx={{\r\n    width:'120px' , height:'60px'\r\n  }}\r\n   >Join Quick room</Button>\r\n   <p id=\"Login-HelperText-QuickRoom\"></p>\r\n          </div>\r\n           </div>\r\n           <div className='SavedRoom-Container'>\r\n\r\n           <Button variant=\"text\"\r\n           id=\"SavedRoom-LoginButton\"\r\n           onClick={()=>{\r\n           \r\n            const ele=document.getElementById(\"SavedRoom-Login-Div\").classList.add(\"Show\");\r\n            \r\n                  const ele2=document.getElementById(\"SavedRoom-LoginButton\").style.display=\"none\";\r\n             }\r\n            }\r\n           >Saved Room</Button>\r\n            <div className=\"Hide\" id=\"SavedRoom-Login-Div\">\r\n           <TextField\r\n          id=\"SavedRoom-Login\"\r\n          label=\"Saved Room ID\"\r\n          type=\"search\"\r\n          variant=\"standard\"\r\n          className=\"SavedRoom-Login\"\r\n        />  </div>\r\n           </div>\r\n           </div>\r\n       </div>\r\n       \r\n   </div>\r\n   <div className=\"LoginSubmit-Div\">\r\n   <Button variant=\"contained\"\r\n   className=\"LoginSubmit\"\r\n   onClick={(e) => {\r\n    \r\n    if(UserName.length<1 || UserName.length>20)  document.getElementById(\"Login-HelperText-Overall\").innerHTML=\"Length Of UserName should be >1 and <21\";\r\n    else if(Password.length<1 || Password.length>20)  document.getElementById(\"Login-HelperText-Overall\").innerHTML=\"Length Of Password should be >1 and <28\";\r\n    else\r\n    submitLogin(e);\r\n  }}\r\n   >Login</Button>\r\n</div>\r\n<p id=\"Login-HelperText-Overall\"></p>\r\n<Button variant=\"contained\" className=\"SignUp-Button\"\r\nonClick = {()=>{\r\n  window.location.replace(\"/SignUp\");\r\n}}\r\nsx={{\r\n marginTop:'4vh'\r\n}}\r\n>SignUp\r\n</Button>\r\n</div>\r\n  );\r\n}\r\n\r\nexport default Login;\r\n","import React ,{useState,useEffect} from \"react\";\r\nimport './Login.css';\r\nimport Box from '@mui/material/Box';\r\nimport TextField from '@mui/material/TextField';\r\nimport Button from '@mui/material/Button';\r\nimport { FcGoogle } from \"react-icons/fc\";\r\nimport { SiFacebook } from \"react-icons/si\";\r\nimport { AiOutlineMail } from \"react-icons/ai\";\r\nimport axios from \"axios\";\r\nimport { Route } from \"react-router\";\r\nimport { useNavigate } from \"react-router-dom\";\r\nimport { NavLink } from \"react-router-dom\";\r\n\r\nconst SignUp = () => {\r\n\r\n    const [UserName, setUserName] = useState(\"\");\r\n    const [Password, setPassword] = useState(\"\");\r\n    const [SecretKey, setSecretKey] = useState(\"\");\r\n    const [AuthStatus, setAuthStatus] = useState(\"NotValid\");\r\n    const [Message, SetMessage] = useState(\"\");\r\n    const [AccessToken, setAccessToken] = useState(\"\");\r\n    const CheckUserName = (e) => {\r\n      setUserName(e.target.value);\r\n      console.log(UserName);\r\n    };\r\n    const CheckPassword = (e) => {\r\n      setPassword(e.target.value);\r\n      console.log(UserName);\r\n    };\r\n    const CheckSecretKey = (e) => {\r\n      setSecretKey(e.target.value);\r\n      console.log(SecretKey);\r\n    };\r\n\r\n    async function submitLogin(e) {\r\n      console.log(UserName);\r\n      console.log(\"Password is \",Password);\r\n      var CheckMessage=\"\";\r\n      await  axios.post(`/Server/Auth/User/SignUp`,  {\r\n        UserName:UserName,\r\n        Password:Password\r\n    }).then(Response=>{\r\n        console.log(Response.data);   \r\n        if (typeof Response.data === 'string' || Response.data instanceof String)\r\n        SetMessage(Response.data);\r\n        console.log(\"response is \" ,Message);\r\n        const accessToken=Response.data.AccessToken;\r\n        if(accessToken){\r\n        localStorage.setItem(`User ${UserName}`, accessToken);\r\n        \r\n    }\r\n        if(Response.data.resval)\r\n        SetMessage(Response.data.resval);\r\n   const AccessToken = localStorage.getItem(`USer ${UserName}`);\r\n   console.log(AccessToken);\r\n    })\r\n\r\n  \r\n     .catch(error=>{\r\n           console.log(\"error while Signing Up\");\r\n               console.log(error);\r\n     })\r\n    \r\n\r\nconst token = localStorage.getItem(`User ${UserName}`);\r\nconsole.log(\"fetched from local->\")\r\n   console.log(token);\r\n    \r\n await axios.get('/Server/Auth/TokenValidate', {headers:{\"authorization\" : `Bearer ${token}`  }}).then(Response=>{\r\n        \r\n      if(Response.data.resval === \"TokenVerified\")\r\n      { window.location.replace(`/Account/${UserName}`);\r\n        \r\n       \r\n      }\r\n    console.log(Response.data); \r\n    \r\n }).catch(error=>{\r\n    console.log(error);\r\n })\r\n\r\n  }\r\n  \r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n  return (\r\n    <div className=\"LoginPage-OverAll\">\r\n    <div className=\"LoginPage-Wrapper\">\r\n   <div className=\"Login-Wrapper\">\r\n       <div className='Login-Container'>\r\n           <div className='User-Pass-Container'>\r\n           <TextField id=\"outlined-basic\" \r\n           label=\"UserName\" \r\n           variant=\"outlined\" \r\n           onChange={(e) => {\r\n            CheckUserName(e);\r\n          }}\r\n          inputProps={{\r\n            style: { fontSize: 18, wordSpacing: 17, lineHeight: 1.5 },\r\n          }}\r\n          InputLabelProps={{\r\n            style: { fontSize: 18, wordSpacing: 17, lineHeight: 1.5 },\r\n          }}\r\n          sx={{boxShadow: 4 }}\r\n           />\r\n           \r\n           <TextField\r\n          id=\"outlined-password-input\"\r\n          label=\"Password\"\r\n          type=\"password\"\r\n          inputProps={{\r\n            style: { fontSize: 18, wordSpacing: 17, lineHeight: 1.5 },\r\n          }}\r\n          InputLabelProps={{\r\n            style: { fontSize: 18, wordSpacing: 17, lineHeight: 1.5 },\r\n          }}\r\n          onChange={(e) => {\r\n            CheckPassword(e);\r\n          }}\r\n          sx={{  boxShadow: 4,  }}\r\n          \r\n        />\r\n           </div>\r\n               <div className='Login-Options'>\r\n\r\n               <FcGoogle className=\"LoginOption-Icons\" />\r\n               <SiFacebook className=\"LoginOption-Icons\" />\r\n               <AiOutlineMail className=\"LoginOption-Icons\" />\r\n           </div>\r\n        \r\n       </div>\r\n       \r\n   </div>\r\n   <div className=\"LoginSubmit-Div\">\r\n   <Button variant=\"contained\"\r\n   className=\"LoginSubmit\"\r\n   onClick={(e) => {\r\n    submitLogin(e);\r\n  }}\r\n   >SignUp</Button>\r\n</div>\r\n</div>\r\n</div>\r\n  );\r\n}\r\n\r\nexport default SignUp;\r\n","import React, { useRef } from 'react'\r\nimport ChatScopeSwitch from '../ChatScopeSwitch/ChatScopeSwitch.js';\r\nimport './ChatWindow.css';\r\nimport ProfileDisplay from '../ProfileDisplay&Rooms/ProfileDisplay&Rooms.js' \r\nimport Message from '../Message/Message.js'\r\nimport { useState,useEffect } from 'react';\r\nimport axios from 'axios'; \r\nimport TextField from '@mui/material/TextField';\r\nimport ArrowBackIcon from '@mui/icons-material/ArrowBack';\r\nimport { IoMdSend ,IoMdMore} from \"react-icons/io\";\r\nimport IconButton from '@mui/material/IconButton';\r\nimport Menu from '@mui/material/Menu';\r\nimport MenuItem from '@mui/material/MenuItem';\r\nimport MoreVertIcon from '@mui/icons-material/MoreVert';\r\nimport RoomHeaderOptions from '../Mui/RoomHeaderOptions.js';\r\nimport { useParams } from 'react-router-dom';\r\nimport Pusher from 'pusher-js'; \r\nimport mongoose from 'mongoose';\r\nimport { io } from \"socket.io-client\";\r\nimport ChatWindowOptions from '../Additional_Components/ChatWindowOptions.js';\r\nimport Paper from '@mui/material/Paper';\r\nimport InputBase from '@mui/material/InputBase';\r\nimport Divider from '@mui/material/Divider';\r\n\r\nimport MenuIcon from '@mui/icons-material/Menu';\r\nimport SearchIcon from '@mui/icons-material/Search';\r\nimport DirectionsIcon from '@mui/icons-material/Directions';\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nvar NewRoomName=\"\";\r\nvar roomtype =\"quick\";\r\n  //  \"start\": \"concurrently \\\"react-scripts start\\\" \\\" cd.. && cd server && npm start\\\"\",\r\n\r\nvar userid =\"\";\r\nvar UserName=\"\";\r\nvar name=\"\";\r\n\r\nconst tempid=new mongoose.Types.ObjectId().toString();\r\nconst ChatWindow = () =>{\r\n\r\nconst [Rooms,setRooms] = useState(new Map());\r\nconst [Members,setMembers] = useState(new Map());\r\nconst [ActiveRoomId,setActiveRoomId] = useState();\r\nconst[ xArray ,setxArray]=useState([ActiveRoomId]);\r\nconst[UserType,setUserType] = useState(\"Quick\");\r\nconst [n,setN] = useState(1);\r\nconst [UserId , setUserId] = useState(\"\");\r\nconst [Messages, setMessages] = useState(new Map());\r\nconst [LastMessage,setLastMessage]=useState(new Map());\r\nconst [ActiveWindow,setActiveWindow] = useState(\"Both\");\r\nconst [TypedMessage, setTypedMessage] = useState(\"\");\r\nconst [OptionState,setOptionState] = useState(null);\r\nconst [RoomCount,setRoomCount] = useState(0);\r\nconst [msg, setMsg] = useState();\r\nconst [Lastmsg, setLastMsg] = useState();\r\nconst [room, setroom] = useState();\r\nconst [delmsg,setdelmsg]=useState();\r\nconst [delmem,setdelmem] = useState();\r\nconst [delroom,setdelroom] = useState();\r\nconst [mem,setmem] = useState();\r\nconst [flag,setflag] = useState();\r\nconst [flag2,setflag2] = useState();\r\nconst [flagLoadMessages,setFlagLoadMessages] = useState(true);\r\nconst [setactmem,actmem] = useState();\r\nconst [ActiveMembers,setActiveMembers] = useState(new Map());\r\nconst [Rerender,setRerender] = useState(0);\r\nconst params= useParams();\r\nuserid= params.UserId;\r\nconsole.log(params);\r\nUserName=userid;\r\nif(!UserName){\r\n  console.log(\"UserName not found\");\r\n  window.location.replace(`/Login`);\r\n}\r\nconsole.log(UserName , \"userName->\");\r\nvar RoomId = params.RoomId;\r\n\r\nvar Name = params.Name;\r\n\r\nuseEffect(()=>{\r\nvar roomExists=true;\r\nif(RoomId){\r\n axios.get(`/Server/QuickRoom/RoomInitial/${RoomId}`)\r\n.then(res=>{ console.log(\"Result from QUick Room Check->\",res.data)\r\n  if(res.data.Status===\"Found\"){\r\n    setRooms(new Map(Rooms.set(res.data.Rooms.RoomId,{ Status:\"Active\" , Name:res.data.Rooms.Name })));\r\n    console.log(\"Quick Room Exists\",res.data.Rooms);\r\n    setflag(true);\r\n    setActiveRoomId(RoomId);\r\n    \r\n  }\r\n  else {createRoom();\r\n    console.log(\"Quick Room Not Found Creating New->\",RoomId);\r\n  }\r\n})\r\n.catch(err=>{\r\n  console.log(\"Error in QUick Room Initialization->\");\r\n  console.log(err);\r\n})\r\n}\r\n},[]);\r\n\r\nuseEffect(()=>{\r\n  if(ActiveRoomId){\r\n    setMessages(new Map(Messages.clear()));\r\n   \r\n  axios.get(`/Server/QuickRoom/Message/load/${ActiveRoomId}`)\r\n  .then(res=>{\r\n    console.log(\"Messages of room loaded\",res.data);\r\n    const Temp=res.data;\r\n    if(Temp){\r\n    for(const message of Temp){\r\n      Messages.set(message.MessageId,message);\r\n    }\r\n  }\r\n    setMessages(new Map(Messages));\r\n    setFlagLoadMessages(!flagLoadMessages);\r\n  })\r\n  .catch(err=>{\r\n    console.log(\"Err in loading messages\",err);\r\n  });\r\n  }\r\n},[ActiveRoomId]);\r\n\r\nuseEffect(()=>{\r\n  if(ActiveRoomId){\r\n  setMembers(new Map(Members.clear()));\r\n    axios.get(`/Server/QuickRoom/Members/load/${ActiveRoomId}`)\r\n    .then(res=>{\r\n       \r\n      console.log(\"Members of room loaded\",res.data);\r\n      const Temp=res.data;\r\n      if(Temp){\r\n      for(const member of Temp){\r\n        Members.set(member.UserId,member);\r\n      }\r\n    }\r\n    if(!Members.has(UserName)) addUser();\r\n      setMembers(new Map(Members));\r\n    })\r\n    .catch(err=>{\r\n      console.log(\"Err in loading members\",err);\r\n    });\r\n  }\r\n},[ActiveRoomId]); \r\n\r\n\r\nvar QuickRoomCount=1;\r\n const createRoom= async()=>{\r\n  if(Rooms.size===0  && UserName){\r\n  console.log(\"creating Quick Room->\",RoomId);\r\n  await axios.post(`/Server/QuickRoom/create/Room/${UserName}`,\r\n    {\r\n      RoomId:RoomId,\r\n      Name:RoomId,\r\n      Members : [{\r\n        UserId:UserName,\r\n        Name:Name,\r\n        RoomId:RoomId\r\n      }],\r\n      Messages:[],\r\n      RoomType : \"quick\"\r\n  })\r\n  .then(res=>{\r\n    console.log(\"created new Quick room\",res.data);\r\n    var temp=res.data;\r\n    setRooms(new Map(Rooms.set(temp.RoomId,{RoomId:temp.RoomId, Name:temp.Name})));\r\n    setflag(true);\r\n    setActiveRoomId(RoomId);\r\n  })\r\n  .catch(err=>{\r\n    console.log(\"Err in creating Quick  room\",err);\r\n  });\r\n}\r\n}\r\nvar User_Name=\"Temp Name\";\r\nconst sendMessage =async()=>{\r\n  const x=document.getElementById('Message-TypeArea').value;\r\n  console.log(\"Typed Message is \" , x);\r\n  console.log(\"Active room ->\",ActiveRoomId);\r\n  await axios.post(`/Server/QuickRoom/Message/add/${ActiveRoomId}`,\r\n  {\r\n    RoomId:ActiveRoomId,\r\n     MessageText:x,\r\n     TimeStamp:Date.now(),\r\n     Sender:UserName,\r\n     Name:Name,\r\n     MessageId:new mongoose.Types.ObjectId().toString()\r\n  })\r\n  .then(res=>{\r\n    console.log(\"Added New Message\",res.data);\r\n  })\r\n  .catch(err=>{\r\n    console.log(\"Err in Adding Message\",err);\r\n  });\r\n}\r\n\r\nconst addUser=async(NewUser)=>{\r\n  if(!Members.has(UserName)){\r\n    console.log(\"User doesnt exist so adding->\",UserName);\r\n  await axios.post(`/Server/QuickRoom/add/User/${RoomId}`,\r\n  {\r\n   UserId:UserName,\r\n   Name:Name,\r\n   RoomId:RoomId\r\n  })\r\n  .then(res=>{\r\n    console.log(\"Added new Member\",res.data);\r\n    \r\n  })\r\n  .catch(err=>{\r\n    console.log(\"Err in adding Member\",err);\r\n  });\r\n}\r\n}\r\n\r\nconst deleteUser = async(UserName,RoomId) =>{\r\n\r\n await axios.post(`/Server/QuickRoom/Delete/Member/${RoomId}/${UserName}`)\r\n.then(res=>{\r\n  console.log(res.data);\r\n}).catch(err=>{\r\n  console.log(err);\r\n});\r\n\r\n}\r\n//   window.addEventListener('beforeunload',function(e){\r\n//     e.preventDefault();\r\n//     deleteUser(UserName,ActiveRoomId);\r\n  \r\n// })\r\n\r\n// window.addEventListener('unload',function(e){\r\n//   e.preventDefault();\r\n//   navigator.sendBeacon(`Server/Room/Delete/Member/${ActiveRoomId}/${UserId}`)\r\n//   deleteUser(UserId,ActiveRoomId);\r\n// });\r\n\r\nuseEffect(()=>{\r\nreturn()=>{\r\ndeleteUser();\r\n}\r\n},[])\r\n\r\nconst [socket,setSocket] = useState(null);\r\nconsole.log(\"socket ->\",socket);\r\nif(socket)\r\nconsole.log(\"socket Id->\",socket.id);\r\n// useEffect(()=>{\r\n  \r\n//   if(socket===null){\r\n//     console.log(\"setting socket->\")\r\n//   setSocket(io());\r\n//   }\r\n//   console.log(\"UseEeffcet Test\");\r\n//     if(socket){\r\n//     socket.on(\"connect\",()=>{\r\n//       console.log(\"Socket connected-> Sending Rooms to server\");\r\n//       const roomsArray = [...Rooms].map(([key,value])=> key);\r\n//   console.log(roomsArray);\r\n//   roomsArray.push(UserName);\r\n//   socket.emit(\"joinRoom\",roomsArray);\r\n// });\r\n\r\n//     }\r\n    \r\n     \r\n//     return ()=>{\r\n//       if(socket){\r\n//      socket.removeAllListeners();  \r\n       \r\n//     }\r\n    \r\n//   }\r\n// },[Rooms,socket]);\r\n\r\n\r\n// useEffect(()=>{\r\n//   if(socket){\r\n// console.log(\"socket Id is \",socket.id);\r\n   \r\n//    socket.on('update',data=>{\r\n//      if(Object.keys(data).length>4){\r\n//        setMsg(data);\r\n//        setLastMsg(data);\r\n//        console.log(\"new  message in socket\",data);\r\n//      }\r\n//      else if(Object.keys(data).length==4){\r\n//        setmem(data);\r\n//        console.log(\"new  member in socket\",data);\r\n//      }\r\n//    });\r\n//    socket.on(\"disconnected\",data=>{\r\n//     if(data){\r\n//       ActiveMembers.delete(data);\r\n//       setActiveMembers(new Map(ActiveMembers));\r\n//     console.log(\"Socket User Left fired\",data);\r\n//     }\r\n//    })\r\n//    socket.on('connected',data=>{\r\n//       if(data){\r\n//         setActiveMembers(new Map(ActiveMembers.set(data,Members.get(data))));\r\n//       }\r\n//       console.log(\"socket USer joined room->\",data);\r\n//    })\r\n  \r\n//     socket.on(\"MemberStatusResponse\",data=>{\r\n//       console.log(\"socket Active Members in Room are \",data);\r\n//       const AM =new Map();\r\n//       ActiveMembers.clear();\r\n//       if(Array.isArray(data)){\r\n//         data.forEach(userId=>{\r\n//             ActiveMembers.set(userId,Members.get(userId));\r\n//         })\r\n//       }\r\n//       setActiveMembers(new Map(ActiveMembers));\r\n//     })\r\n//   }\r\n// return ()=>{\r\n//   if(socket){\r\n//  socket.removeAllListeners();  \r\n//      socket.disconnect();\r\n// }\r\n// }\r\n\r\n// },[socket,ActiveRoomId]);\r\n\r\n// useEffect(()=>{\r\n//   if(socket){\r\n//   socket.emit(\"MemberStatus\",ActiveRoomId);\r\n//   }\r\n// },[ActiveRoomId])\r\n\r\n//const [socket,setSocket] = useState(null);\r\nconsole.log(\"Socket is\",socket);\r\nuseEffect(()=>{\r\n  const port = process.env.fakePort;\r\n  console.log(\"window hostname\",window.location.hostname);\r\n  if(socket===null)\r\n  setSocket(io());\r\n \r\n \r\n  \r\n  \r\n    if(socket){\r\n    socket.on(\"connect\",()=>{\r\n      console.log(socket.id);\r\n      var roomsArray=[];\r\n[...Rooms].map(([key,value])=> roomsArray.push(key));\r\nroomsArray.push(UserName);\r\nconsole.log(roomsArray);\r\n  socket.emit(\"joinRoom\",roomsArray); \r\n});\r\n\r\n    }\r\n\r\n    return ()=>{\r\n      if(socket){\r\n      socket.on('disconnect', () => { \r\n        console.log(\"disccoented\");\r\n        socket.removeAllListeners();  \r\n        socket.off(\"connect\"); \r\n       \r\n     });\r\n     \r\n    }\r\n    \r\n  }\r\n},[flag]);\r\n\r\n\r\nuseEffect(()=>{\r\n  if(socket){\r\nconsole.log(\"socket Id is \",socket.id);\r\n   \r\n   socket.on('update',data=>{\r\n     if(Object.keys(data).includes(\"MessageId\")){\r\n       setMsg(data);\r\n       setLastMsg(data);\r\n       console.log(\"new  message in socket\",data);\r\n     }\r\n     else if(Object.keys(data).includes(\"UserId\")){\r\n       setmem(data);\r\n       console.log(\"new  member in socket\",data);\r\n     }\r\n    \r\n   });\r\n\r\n  socket.on('insert',data=>{\r\n    console.log(\"New Room Detected in Socket\",data)\r\n    if(data){\r\n      socket.emit(\"joinRoom\",[data.RoomId,UserName]);\r\n    }\r\n    setroom(data);\r\n  });\r\n\r\n  \r\n    \r\n  socket.on(\"disconnected\",data=>{\r\n    if(data && Members.has(data)){\r\n      ActiveMembers.delete(data);\r\n      setActiveMembers(new Map(ActiveMembers));\r\n    console.log(\"Socket User Left fired\",data);\r\n    }\r\n   })\r\n   socket.on('connected',data=>{\r\n      if(data){\r\n        setActiveMembers(new Map(ActiveMembers.set(data,Members.get(data))));\r\n      }\r\n      console.log(\" USer joined room->\",data);\r\n   })\r\n  \r\n    socket.on(\"MemberStatusResponse\",data=>{\r\n      console.log(\"Active Members in Room are \",data);\r\n      const AM =new Map();\r\n      ActiveMembers.clear();\r\n      if(Array.isArray(data)){\r\n        data.forEach(userId=>{\r\n            ActiveMembers.set(userId,Members.get(userId));\r\n        })\r\n      }\r\n      setActiveMembers(new Map(ActiveMembers));\r\n    })\r\n\r\n  }\r\nreturn ()=>{\r\n  if(socket){\r\n  \r\n    console.log(\"disccoented\");\r\n    socket.removeAllListeners();  \r\n    \r\n     socket.disconnect();\r\n}\r\n}\r\n\r\n},[socket]);\r\n\r\n\r\nuseEffect(()=>{\r\n  if(socket){\r\n    console.log(\"asking active members for room\",ActiveRoomId);\r\n  socket.emit(\"MemberStatus\",ActiveRoomId);\r\n  }\r\n},[ActiveRoomId,flag,RoomId,Rerender])\r\n\r\nconsole.log(\"Active Members->\",ActiveMembers);\r\nuseEffect(() => {\r\n\r\n \r\n    //  [...Rooms.keys()].map(romId=>{\r\n       \r\n    //  });\r\n\r\n\r\n    \r\n  \r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n  //    //Pusher.logToConsole = true;\r\n      var pusher = new Pusher('d3a40ccf8c32cd64d3ac', {\r\n       cluster: 'ap2',\r\n       encrypted:true,\r\n     });\r\n  \r\n     var deleteChannel = pusher.subscribe('delete');\r\n     deleteChannel.bind('Message',function(data){console.log(\"Pusher -> delete message\",data);\r\n     if(data){ console.log(ActiveRoomId,data.RoomId);\r\n       if(data.RoomId===ActiveRoomId)\r\n       setdelmsg(data);\r\n     }\r\n     });\r\n     deleteChannel.bind('Member',function(data){console.log(\"Pusher -> delete member\",data);\r\n       if(data){ \r\n        if(data.RoomId===ActiveRoomId){\r\n          console.log(\"Member deleted\");\r\n         setdelmem(data);\r\n        }\r\n       }\r\n     });\r\n     deleteChannel.bind('Room',function(data){\r\n      if(data){\r\n        if(data.UserId===UserName)\r\n        setdelroom(data);\r\n      }\r\n    });\r\n  \r\n  // var MessageChannel = pusher.subscribe('Messages');\r\n  // MessageChannel.bind('inserted', function(data) {\r\n  //  setLastMsg(data);\r\n  //  if(ActiveRoomId===data.RoomId) setMsg(data);\r\n  //   console.log(\"Triggered pusher-> Message added\",data);\r\n  //   console.log(\"Active ->\",ActiveRoomId,\"newmessage ->\", data.RoomId, ActiveRoomId===data.RoomId);\r\n    \r\n    \r\n  // });\r\n  \r\n    \r\n  // MessageChannel.bind('deleted', function(data) {\r\n   \r\n  //   console.log(\"Triggered pusher-> Message deleted\",data);\r\n   \r\n  //  //iterate and set all messages as data is full messages array\r\n  // });\r\n  \r\n  // MessageChannel.bind('updated', function(data) {\r\n    \r\n  //   console.log(\"Triggered pusher-> Message updated\",data);\r\n  //   setLastMsg(data);\r\n   \r\n  // });\r\n  \r\n  // var MemberChannel = pusher.subscribe(\"Members\");\r\n  // MemberChannel.bind('inserted', function(data) {\r\n  //   setmem(data);\r\n  //   console.log(\"Triggered pusher-> Member added\",data);\r\n    \r\n  // });\r\n  \r\n  // MemberChannel.bind('deleted', function(data) {\r\n  //   console.log(\"Triggered pusher-> Member deleted\",data);\r\n  //  //iterate and set\r\n  //  setdelmem(data);\r\n  // });\r\n  \r\n  // MemberChannel.bind('updated', function(data) {\r\n  //  setmem(data);\r\n  //   console.log(\"Triggered pusher-> Member updated\",data);\r\n   \r\n  // });\r\n  \r\n  // var RoomChannel = pusher.subscribe('Rooms');\r\n\r\n  // RoomChannel.bind('inserted', function(data) {\r\n  //   if(data){\r\n  //   console.log(\"Triggered pusher-> Room added\",data.NewRoom);\r\n  //  setroom(data.NewRoom);\r\n  // }\r\n  // });\r\n  \r\n  // RoomChannel.bind('deleted', function(data) {\r\n  //   console.log(\"Triggered pusher-> Room deleted\",data);\r\n  //   setdelroom(data);\r\n  // });\r\n  \r\n  // RoomChannel.bind('updated', function(data) {\r\n  //   setroom(data);\r\n  //   console.log(\"Triggered pusher-> Room updated\",data);\r\n    \r\n    \r\n  // });\r\n  // return () => {\r\n  //   pusher.unsubscribe(\"Messages\");\r\n  //   pusher.unsubscribe(\"Members\");\r\n  //   pusher.unsubscribe(\"Rooms\");\r\n  // };\r\n  return ()=>{\r\n    pusher.unsubscribe('delete');\r\n  };\r\n  \r\n}, []);\r\n\r\n\r\n\r\n\r\nuseEffect(() => {console.log(\"New Message useEffect fired  \",msg);\r\nif (msg) { console.log(\"New Message is \",msg);\r\nconst temp=msg;\r\nsetMessages(new Map(Messages.set(temp.MessageId,temp)));\r\nscrollToBottom();\r\n}\r\n}, [msg]);\r\n\r\nuseEffect(() => {console.log(\"New LastMessage useEffect fired  \",Lastmsg);\r\nif(Lastmsg){\r\nconst temp=Lastmsg;\r\nsetLastMessage(new Map(LastMessage.set(temp.RoomId,temp.MessageText)));\r\n //if (Lastmsg) setLastMessage(new Map(LastMessage.set(Lastmsg.RoomId,Lastmsg)));\r\n}\r\n}, [Lastmsg]);\r\n\r\nuseEffect(() => {console.log(\"New Member useEffect fired  \",mem);\r\nif (mem) { console.log(\"New Member is \",mem);\r\nconst temp=mem;\r\nsetMembers(new Map(Members.set(temp.UserId,temp)));\r\n}\r\n}, [mem]);\r\n\r\n\r\nuseEffect(() => {\r\nif (room) {\r\n  const temp=room;\r\n  console.log(\"New Room is\",room);\r\n  console.log(\"New Room Id is\",temp.RoomId);\r\n   setRooms(new Map(Rooms.set(temp.RoomId,{RoomId:temp.RoomId, Name:temp.Name})));\r\n  \r\n//    if(room.UserId === UserName) setRooms(new Map(Rooms.set(room.RoomId,\"inactive\")));\r\n}\r\n}, [room]);\r\n\r\nuseEffect(() => {console.log(\"delete Message useEffect fired  \",msg);\r\nif (delmsg && Messages.has(delmsg.RoomId)) { console.log(\"delete Message is \",delmsg);\r\nconst temp=delmsg;\r\nif(ActiveRoomId===temp.RoomId){\r\nMessages.delete(temp.MessageId);\r\nconst X=Messages;\r\nsetMessages(new Map(X));\r\n}\r\n}\r\n}, [delmsg]);\r\n\r\nuseEffect(() => {\r\n  console.log(\"Delete Member USeEffect Fired->\",delmem);\r\nif(delmem && Members.has(delmem.UserId)){\r\nconst temp=delmem;\r\nconsole.log(\"testting delete member roomid\",ActiveRoomId===delmem.RoomId)\r\n  console.log(\"delete member useEffect fired  \",delmem.UserId);\r\n  Members.delete(temp.UserId);\r\n  const X=Members;\r\nsetMembers(new Map(X));\r\n //if (Lastmsg) setLastMessage(new Map(LastMessage.set(Lastmsg.RoomId,Lastmsg)));\r\n}\r\n}, [delmem]);\r\n\r\nuseEffect(() => {\r\nif (delroom) {\r\n  console.log(\"delete room use effect fired for \", delroom);\r\n  const temp=delroom;\r\n  if(Rooms.has(temp.RoomId)){\r\n    Rooms.delete(temp.RoomId);\r\n    const X=Rooms;\r\n    setRooms(new Map(X));}\r\n    //    if(room.UserId === UserName) setRooms(new Map(Rooms.set(room.RoomId,\"inactive\")));\r\n}\r\n}, [delroom]);\r\n\r\n\r\nuseEffect(()=>{\r\nwindow.addEventListener('resize',function(e){\r\nconst wid = window.innerWidth;\r\nconst hei = window.innerHeight;\r\nif(wid<=600 && ActiveWindow===\"Both\") setActiveWindow(\"ChatWindow\");\r\nelse if(wid>600) setActiveWindow(\"Both\");\r\n});\r\nreturn()=>{\r\n window.removeEventListener('resize',function(){\r\n  console.log(\"Removed Event\")\r\n })\r\n};\r\n},[])\r\n\r\n\r\nconsole.log(\"Members before rendering are\",Members);\r\nconsole.log(\"Rooms before rendering are\",Rooms);\r\n   const loadMessages= (RoomId) =>{\r\n      setActiveRoomId(RoomId);\r\n   }\r\n   var count=0;\r\nconsole.log(LastMessage);\r\n    var width,height;\r\n\r\n\r\n    const messagesEndRef = useRef(null);\r\n\r\n    const scrollToBottom = () => {\r\n      messagesEndRef.current?.scrollIntoView({ behavior: \"smooth\" });\r\n      var objDiv = document.getElementById(\"ScrollDownDiv\");\r\nobjDiv.scrollIntoView(false);\r\n    }\r\n    useEffect(() => {\r\n      scrollToBottom();\r\n    }, [flagLoadMessages]);\r\n \r\n    var ChatWindowOptionsX=null;\r\n    \r\n       \r\n    return (\r\n     <div className=\"ContentWrapper\">\r\n       \r\n       <div className ={\"Room-container-Wrapper\" + (ActiveWindow===\"ChatWindow\"? \" Hide\" : \"\")}>\r\n        \r\n        <div className=\"Room-container\">\r\n        \r\n        <div className=\"Room-Header-Wrapper\">\r\n            <div className=\"Room-Header-scopeSwitch\">\r\n               <ChatScopeSwitch>\r\n                   \r\n                </ChatScopeSwitch>\r\n           </div>\r\n           <div className=\"Room-Header-contents\">\r\n           <Paper\r\n      component=\"form\"\r\n      sx={{ p: '2px 4px', display: 'flex', alignItems: 'center', width: '89%' }}\r\n    >\r\n      <div className='RoomSearchBarContainer' id=\"RoomSearchBarContainer\">\r\n      <InputBase\r\n      id=\"RoomSearchBar\"\r\n        sx={{ ml: 1, flex: 1 }}\r\n        placeholder=\"Search Rooms\"\r\n        inputProps={{ 'aria-label': 'Search Rooms' }}\r\n      />\r\n      <IconButton type=\"submit\" sx={{ p: '10px' , flex:0.3 }} aria-label=\"search\">\r\n        <SearchIcon />\r\n      </IconButton>\r\n      </div>\r\n     \r\n    </Paper>\r\n             {/* <IoMdMore className=\"OptionsMenu-RoomHeader\"/> */}\r\n             \r\n             \r\n           </div>\r\n           </div>\r\n           <div className=\"Room-Window-Wrapper\">\r\n           <div className=\"Room-Window\">\r\n              \r\n        {/*  add rooms */}\r\n        {\r\n       \r\n          [...Rooms.keys()].map(roomid=>{\r\n           \r\n            return(\r\n           <div onClick={()=>{\r\n                   setRerender(Rerender+1);\r\n                    width = document.body.clientWidth;\r\n                   setActiveRoomId(roomid);\r\n                     console.log(\"Active RoomID is \",ActiveRoomId , roomid, ActiveRoomId===roomid);\r\n                   if(width<=600)\r\n                     setActiveWindow(\"ChatWindow\"); }}>\r\n           <ProfileDisplay ProfileName={roomid} LastMessage={LastMessage.get(roomid)}/>\r\n           </div>\r\n            );\r\n          })\r\n        }\r\n            </div>\r\n           </div>\r\n\r\n        </div>\r\n        </div>\r\n\r\n        <div className={\"Chat-container-Wrapper\" +(ActiveWindow===\"RoomWindow\"? \" Hide\":\"\") }\r\n        id=\"Chat-Container-Wrapper\"\r\n        >\r\n            <div className=\"Chat-Container\"  >\r\n        <div className=\"Chat-Header-Wrapper\" \r\n       >\r\n            <div className=\"Chat-Header\"\r\n            \r\n            >\r\n              <div className='backArrow-ChatHeader'>\r\n                <ArrowBackIcon className={\"BackArrow-ChatWindow BackArrowRes backArrow-ChatHeader\"} \r\n                onClick={()=>{setActiveWindow(\"RoomWindow\")}}\r\n                sx={{\r\n                  width:'40px' , height:'30px'\r\n                }}\r\n                />\r\n                </div>\r\n                <div className=\"RoomDetails-Wrapper-ChatHeader\"\r\n                 onClick={(e)=>{\r\n                  \r\n                   var ChatContainer=document.getElementById(\"Chat-Container-Wrapper\");\r\n                   if(ChatContainer){\r\n                     ChatContainer.classList.add(\"Hide\");\r\n                     var RoomDetails = document.getElementById(\"RoomDetails-FullDetails\");\r\n                     if(RoomDetails){\r\n                      RoomDetails.classList.remove(\"Hide\");\r\n                     }\r\n                   }\r\n                 }}\r\n                >\r\n                  <img className='RoomDetails-Avatar-ChatHeader'  src=\"\" alt=\"error\" />\r\n                  <div className='RoomDetails-Name-ChatHeader'>\r\n                    {RoomId}\r\n                  </div>\r\n                </div>\r\n                <div className='RoomOptions-ChatHeader'>\r\n                  <div className='RoomDetails-ChatHeader'>\r\n                  </div>\r\n                  <div className='Search-ChatHeader'>\r\n                  <Paper\r\n      component=\"form\"\r\n      sx={{ p: '2px 4px', display: 'flex', alignItems: 'center', width: '89%' }}\r\n    >\r\n      <div className='ChatSearchBarContainer' id=\"ChatSearchBarContainer\">\r\n      <InputBase\r\n      id=\"ChatSearchBar\"\r\n        sx={{ ml: 1, flex: 1 }}\r\n        placeholder=\"Search Chat\"\r\n        inputProps={{ 'aria-label': 'Search Chat' }}\r\n      />\r\n      <IconButton type=\"submit\" sx={{ p: '10px' , flex:0.3 }} aria-label=\"search\">\r\n        <SearchIcon />\r\n      </IconButton>\r\n      </div>\r\n      <Divider sx={{ height: 28, m: 0.5 }} orientation=\"vertical\" />\r\n      <ChatWindowOptions Members={Members}  ActiveRoomId={ActiveRoomId}  />\r\n    </Paper>\r\n                  </div>{console.log(\"Active Room id is->\",ActiveRoomId)}\r\n                \r\n                </div>  \r\n                </div>\r\n            </div>\r\n           \r\n            <div className=\"Chat-Box-Wrapper\" id=\"Chat-Box-Wrapper\" >\r\n            <div className=\"Chat-Box\">\r\n               {console.log(Messages.size)}\r\n            { \r\n                 [...Messages.keys()].map(message=>{ \r\n                  var time =new Date(Messages.get(message).TimeStamp);\r\n                  time= time.toString().split(' ');\r\n                  console.log(\"Time parts\",time);\r\n                 time=time[1]+ \" \" + time[2] + \" \"+ time[3] + \" \" + time[4] ;\r\n                   return(\r\n                     <Message \r\n                     own={Messages.get(message).Sender===UserName}\r\n                     MessageText={Messages.get(message).MessageText}\r\n                     Name={Messages.get(message).Name}\r\n                     TimeStamp={time}\r\n                     />\r\n                   );\r\n                 })\r\n            }\r\n            <div ref={messagesEndRef} id=\"ScrollDownDiv\" />\r\n            </div>\r\n            <div className='Members-Wrapper-ChatContainer'>\r\n              <p className='WhiteTextOnDarkBG H2'>\r\n              Members:  </p>\r\n              <div className='MembersList-ChatContainer'>\r\n\r\n                  {\r\n                    [...ActiveMembers.keys()].map(key=>{ if(!Members.get(key)) return null\r\n                      return(\r\n                        <div className='MemberWrapper-ChatContainer'>\r\n                      <div className=\"MemberName-ChatContainer ActiveMember-Online\">\r\n                         {Members.get(key).Name} \r\n                      </div>\r\n                      <div className='MemberStatus-ChatContainer'>\r\n\r\n                      </div>\r\n                    </div>\r\n                      )\r\n                    })\r\n                  }\r\n\r\n\r\n                {\r\n                  [...Members.keys()].map(key=>{ if(ActiveMembers.has(key)) return null;\r\n                    return(\r\n                    <div className='MemberWrapper-ChatContainer'>\r\n                      <div className=\"MemberName-ChatContainer\">\r\n                        {Members.get(key).Name}\r\n                      </div>\r\n                      <div className='MemberStatus-ChatContainer'>\r\n\r\n                      </div>\r\n                    </div>\r\n                    )\r\n                  })\r\n                }\r\n              </div>\r\n             </div>\r\n            </div>\r\n            <div className=\"Type-Menu\">\r\n               \r\n                <div className=\"emoji-Stickers\">\r\n\r\n                </div>\r\n            </div>\r\n        \r\n        \r\n        <div className='TypeArea'>\r\n          <div className='TypeBox-Container'>\r\n          <TextField\r\n          id=\"Message-TypeArea\"\r\n          label=\"Message\"\r\n          placeholder=\"Message\"\r\n          multiline \r\n          maxRows={3}\r\n          \r\n          \r\n          onKeyPress={(ev) => {\r\n            if (ev.key === 'Enter') {\r\n             if(ev.shiftKey){ sendMessage();\r\n              ev.preventDefault();\r\n             }\r\n            }\r\n          }}\r\n          sx={{width:'90%',margin:'10px', maxWidth:'700px'  , boxShadow:4}}\r\n        /> \r\n          \r\n          \r\n          </div>\r\n          <div className='TypeArea-SendButton'>\r\n                   <IoMdSend  \r\n                   className='Chat-SendButton'\r\n                   \r\n                   onClick={()=>{ \r\n                    var typedMssg = document.getElementById('Message-TypeArea').value;\r\n                    console.log(\"Submitted Message  is \" , typedMssg);\r\n                       if(typedMssg.length>0)\r\n                       sendMessage();\r\n                       else alert(\"Type atleast 1 Letter\");\r\n                   }}  \r\n                   \r\n                   />\r\n          </div>\r\n        </div>\r\n        </div>\r\n        </div>\r\n    \r\n        <div className='RoomDetails-FullDetails Hide'\r\n            id=\"RoomDetails-FullDetails\"\r\n            >\r\n            <div className='RoomInside-DetailsHeader'>\r\n            <ArrowBackIcon className={\"BackArrow-ChatWindow BackArrowRes backArrow-ChatHeader\"} \r\n                onClick={()=>{\r\n                 var x =document.getElementById(\"RoomDetails-FullDetails\");\r\n                 if(x)  x.classList.add(\"Hide\");\r\n                 x=document.getElementById(\"Chat-Container-Wrapper\");\r\n                 if(x) x.classList.remove(\"Hide\");\r\n                }}\r\n                sx={{\r\n                  width:'40px' , height:'30px'\r\n                }}\r\n                />\r\n            </div> \r\n            Members : \r\n             <div className='RoomInside-MembersList'>\r\n             {\r\n              [...ActiveMembers.keys()].map(mem=>{ if(!Members.has(mem)) return null\r\n                return(\r\n                  <div className=\"Member-InsideDetailsList-Wrapper\">\r\n                    <img className=\"MemberAvatar-InsideDetailsList\"  src=\"\" alt=\"error\" />\r\n                    <div className='MemberName-InsideDetailsList ActiveMember-Online'>\r\n                      {Members.get(mem).Name}\r\n                    </div>\r\n                  </div>\r\n                )\r\n              })\r\n             }\r\n              {\r\n                [...Members.keys()].map(key=>{if(ActiveMembers.has(key)) return null;\r\n                  return(\r\n                    <div className=\"Member-InsideDetailsList-Wrapper\">\r\n                      <img className=\"MemberAvatar-InsideDetailsList\"  src=\"\" alt=\"error\" />\r\n                      <div className='MemberName-InsideDetailsList'>\r\n                        {Members.get(key).Name}\r\n                      </div>\r\n                    </div>\r\n                  )\r\n                })\r\n              }\r\n             </div>\r\n            </div>\r\n\r\n        </div>\r\n    );\r\n}\r\n\r\nexport default ChatWindow;","\r\n  import { BrowserRouter as Router, Route, Link } from 'react-router-dom';\r\n  import { Routes } from 'react-router-dom';\r\n  import React , {Component}from \"react\";\r\n  import ChatWindow from './ChatWindow/ChatWindow.js'\r\n  import Home from './Home/Home.js'\r\n  import Login from './Login/Login.js';\r\n  import SignUp from './Login/SignUp.js';\r\n  import QuickChatWindow from './ChatWindow/QuickChat.js';\r\n  const RoutesComponent = () => {\r\nreturn(\r\n<div className='Content-wrapper'>\r\n<Routes>\r\n  \r\n  <Route exact path=\"/Account/:UserName\" element={<ChatWindow/>}/>\r\n  <Route exact path=\"/Home/:UserName\" element={<Home/>}/>\r\n  <Route exact path=\"/Login\" element={<Login/>}/>\r\n  <Route exact path=\"/SignUp\" element={<SignUp/>}/>\r\n  {/* <Route exact path=\"/Account/Settings/:UserName\" element={<Settings/>}/> */}\r\n  <Route exact path=\"/\" element={<Home/>}/>\r\n  <Route exact path=\"/Account\" element={<ChatWindow/>}/>\r\n  <Route exact path=\"/QuickRoom/:UserType/:RoomId/:UserId/:Name\" element={<QuickChatWindow/>}/>\r\n  <Route exact path=\"/SavedRoom/:RoomId/:UserId\" element={<ChatWindow/>}/>\r\n  <Route exact path=\"/SavedRoom/:RoomId\" element={<ChatWindow/>}/>\r\n  {/* <Route exact path=\"/Account/Settings\" element={<Settings/>}/> */}\r\n  </Routes>\r\n</div>\r\n);\r\n  }\r\n\r\n  export default RoutesComponent","import React from 'react'\nimport './App.css';\nimport ChatWindow from './Components/ChatWindow/ChatWindow.js'\nimport RoutesComponent from './Components/RoutesComponent.js'\nimport { BrowserRouter as Router, Route, Link ,Routes } from 'react-router-dom';\nimport Home from './Components/Home/Home.js'\nimport Login from './Components/Login/Login';\nimport SignUp from './Components/Login/SignUp';\nfunction App() {\n  return(\n    <Router>\n  <div className=\"Content-wrapper\">\n <RoutesComponent>\n   \n </RoutesComponent>\n</div>\n</Router>\n  );\n}\n\nexport default App;\n\n\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\n\nReactDOM.render(\n \n    <App />,\n  \n  document.getElementById('root')\n);\n\n\n"],"sourceRoot":""}